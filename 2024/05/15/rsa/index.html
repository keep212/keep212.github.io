



<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="圥忈的博客" href="http://example.com/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="圥忈的博客" href="http://example.com/atom.xml" />
<link rel="alternate" type="application/json" title="圥忈的博客" href="http://example.com/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="rsa" />


<link rel="canonical" href="http://example.com/2024/05/15/rsa/">



  <title>
'rsa' |
Yume Shoka = 圥忈的博客 = Slowly learn something</title>
<meta name="generator" content="Hexo 7.2.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">'rsa'
  </h1>
  
<div class="meta">
  <span class="item" title="创建时间：2024-05-15 13:47:22">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">发表于</span>
    <time itemprop="dateCreated datePublished" datetime="2024-05-15T13:47:22+08:00">2024-05-15</time>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="切换导航栏">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">Yume Shoka</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
          <img src="/./assets/rsa.jpg">
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">首页</a></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="http://example.com/2024/05/15/rsa/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="luren">
    <meta itemprop="description" content="Slowly learn something, ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="圥忈的博客">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h1 id="ctf-rsapython安装及pycharm配置"><a class="markdownIt-Anchor" href="#ctf-rsapython安装及pycharm配置">#</a> 【CTF-RSA】python 安装及 pycharm 配置</h1>
<p>python3 官网下载地址<br>
<span class="exturl" data-url="aHR0cHM6Ly93d3cucHl0aG9uLm9yZy9kb3dubG9hZHMvd2luZG93cy8="> https://www.python.org/downloads/windows/</span></p>
<p>python 编译器 pycharm Community 下载地址<br>
<span class="exturl" data-url="aHR0cHM6Ly93d3cuamV0YnJhaW5zLmNvbS96aC1jbi9weWNoYXJtL2Rvd25sb2FkLyNzZWN0aW9uPXdpbmRvd3M="> https://www.jetbrains.com/zh-cn/pycharm/download/#section=windows</span></p>
<p>pycharm 汉化插件<br>
打开 pycharm 左上角的 file (文件) &gt; 选择 settings (设置) &gt; 打开 plugins (插件) &gt; 搜索 chinese (中文插件), 下载好后重启 pycharm</p>
<p>pycharm 设置虚拟环境<br>
设置虚拟环境的好处是：</p>
<p>1. 方便移植和重装系统以后，安装模块</p>
<p>2. 避免安装较多模块，发生冲突</p>
<p>pycharm 安装库及设置国内镜像<br>
中国科技大学 <span class="exturl" data-url="aHR0cHM6Ly9weXBpLm1pcnJvcnMudXN0Yy5lZHUuY24vc2ltcGxlLw==">https://pypi.mirrors.ustc.edu.cn/simple/</span></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">安装 libnum 库</span><br><span class="line">pip install libnum -i https://pypi.mirrors.ustc.edu.cn/simple/</span><br><span class="line">安装 pycryptodome库</span><br><span class="line">pip install pycryptodome -i https://pypi.mirrors.ustc.edu.cn/simple/ </span><br></pre></td></tr></table></figure>
<p>gmpy2 及相关库安装<br>
<span class="exturl" data-url="aHR0cHM6Ly93d3cubGZkLnVjaS5lZHUvfmdvaGxrZS9weXRob25saWJzLw=="> https://www.lfd.uci.edu/~gohlke/pythonlibs/</span></p>
<p>在该网页中找到 gmpy2, 注意找对应得版本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">gmpy2‑2.0.8‑cp39‑cp39‑win_amd64.whl</span><br><span class="line">gmpy2‑2.0.8‑cp39‑cp39‑win32.whl</span><br><span class="line">gmpy2‑2.0.8‑cp38‑cp38‑win_amd64.whl</span><br><span class="line">gmpy2‑2.0.8‑cp38‑cp38‑win32.whl</span><br><span class="line">gmpy2‑2.0.8‑cp37‑cp37m‑win_amd64.whl</span><br><span class="line">gmpy2‑2.0.8‑cp37‑cp37m‑win32.whl</span><br><span class="line">gmpy2‑2.0.8‑cp36‑cp36m‑win_amd64.whl</span><br><span class="line">gmpy2‑2.0.8‑cp36‑cp36m‑win32.whl</span><br><span class="line">gmpy2‑2.0.8‑cp35‑cp35m‑win_amd64.whl</span><br><span class="line">gmpy2‑2.0.8‑cp35‑cp35m‑win32.whl</span><br><span class="line">gmpy2‑2.0.8‑cp34‑cp34m‑win_amd64.whl</span><br><span class="line">gmpy2‑2.0.8‑cp34‑cp34m‑win32.whl</span><br><span class="line">gmpy2‑2.0.8‑cp27‑cp27m‑win_amd64.whl</span><br><span class="line">gmpy2‑2.0.8‑cp27‑cp27m‑win32.whl</span><br></pre></td></tr></table></figure>
<p>N（Modulus）：模数，是两个大素数 P 和 Q 的乘积。N 的长度决定了 RSA 算法的安全性。</p>
<p>E（Public Exponent）：公钥指数，通常为 65537（0x10001）。E 用于加密数据，是公钥的一部分。</p>
<p>P（Prime Factor）：素数 P，是模数 N 的一个因子。</p>
<p>Q（Prime Factor）：素数 Q，是模数 N 的另一个因子。</p>
<p>DP（D mod (P-1)）：D 对 (P-1) 取模的结果，用于解密数据。</p>
<p>DQ（D mod (Q-1)）：D 对 (Q-1) 取模的结果，用于解密数据。</p>
<p>Qinv（Q^-1 mod P）：Q 的模 P 的乘法逆元，用于解密数据。</p>
<p>D（Private Exponent）：私钥指数，用于解密数据或生成数字签名</p>
<h1 id="ctf-rsarsa简介及原理"><a class="markdownIt-Anchor" href="#ctf-rsarsa简介及原理">#</a> 【CTF-RSA】RSA 简介及原理</h1>
<h2 id="rsa算法简介"><a class="markdownIt-Anchor" href="#rsa算法简介">#</a> rsa 算法简介</h2>
<p>RSA 是公钥密码体制，是一种使用不同的加密密钥与解密密钥</p>
<p><img data-src="https://raw.githubusercontent.com/keep212/nima/main/5fb3c27329b8976a11a47a59deb864d84769fda0.png%401256w_478h_!web-article-pic.avif" alt=""></p>
<p><img data-src="https://raw.githubusercontent.com/keep212/nima/main/8a70da17879fa97dbf424abbeb5a4ff94e1ad396.png%401256w_358h_!web-article-pic.avif" alt=""></p>
<h2 id="rsa算法原理"><a class="markdownIt-Anchor" href="#rsa算法原理">#</a> rsa 算法原理</h2>
<h3 id="欧拉函数φn"><a class="markdownIt-Anchor" href="#欧拉函数φn">#</a> 欧拉函数 φ(n)</h3>
<p>欧拉函数 φ(n) 的定义是小于 n 的自然数中与 n 互质的数的个数</p>
<h3 id="欧拉定理"><a class="markdownIt-Anchor" href="#欧拉定理">#</a> 欧拉定理</h3>
<p>若 n,a 为正整数，且 n,a 互质，则:a^φ(n)≡1 mod n</p>
<h3 id="费马小定理"><a class="markdownIt-Anchor" href="#费马小定理">#</a> 费马小定理</h3>
<p><img data-src="https://raw.githubusercontent.com/keep212/nima/main/7f87d43d837599c2d6d759300d780c7ef60f336f.png%401256w_274h_!web-article-pic.avif" alt=""></p>
<h3 id="模运算"><a class="markdownIt-Anchor" href="#模运算">#</a> 模运算</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">(a + b) % p = (a % p + b % p) % p</span><br><span class="line">(a - b) % p = (a % p - b % p) % p</span><br><span class="line">(a * b) % p = (a % p * b % p) % p</span><br><span class="line">a ^ b % p = ((a % p) ^ b) % p</span><br><span class="line">结合律</span><br><span class="line">((a + b) % p + c) = (a + (b + c) % p) % p</span><br><span class="line">((a * b) % p * c) = (a * (b * c) % p) % p</span><br><span class="line">交换律</span><br><span class="line">(a + b) % p = (b + a) % p</span><br><span class="line">(a * b) % p = (b * a) % p</span><br><span class="line">分配律</span><br><span class="line">(a + b) % p = (a % p + b % p) % p</span><br><span class="line">((a + b) % p * c) % p = ((a * c) % p + (b * c) % p</span><br><span class="line">重要定理</span><br><span class="line">若 a ≡ b (mod p)，则对于任意的 c，都有(a + c) ≡ (b + c) (mod p)</span><br><span class="line">若 a ≡ b (mod p)，则对于任意的 c，都有(a * c) ≡ (b * c) (mod p)</span><br><span class="line">若 a ≡ b (mod p)，c ≡ d (mod p)，则</span><br><span class="line">(a + c) ≡ (b + d) (mod p)</span><br><span class="line">(a - c) ≡ (b - d) (mod p)</span><br><span class="line">(a * c) ≡ (b * d) (mod p)</span><br><span class="line">(a / c) ≡ (b / d) (mod p)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">逆元</span><br><span class="line">a mod p的逆元便是可以使 a * a&#x27; mod p = 1 的最小a&#x27;。</span><br></pre></td></tr></table></figure>
<h3 id="推导过程"><a class="markdownIt-Anchor" href="#推导过程">#</a> 推导过程</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">式1：c=m^e%N</span><br><span class="line">式2：m=c^d%N</span><br></pre></td></tr></table></figure>
<p>将式 1 带入式 2 得 m = (m ^ e % N) ^ d % N</p>
<p>需要证明：m == (m ^ e % N) ^ d % N</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(m^e%N)^d%N</span><br><span class="line"></span><br><span class="line">=&gt;  (m^e)^d%N #模运算 a ^ b % p = ((a % p) ^ b) % p</span><br><span class="line"></span><br><span class="line">m^(e*d)%N #幂的乘方，底数不变，指数相乘</span><br></pre></td></tr></table></figure>
<p>将 e * d ≡ 1 (mod φ(N)) 即 e * d = K * φ(N) + 1，K 为任意正整数，代入得：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">=&gt; (m^(K*φ(N)+1))%N</span><br><span class="line"></span><br><span class="line">=&gt; (m^(K*φ(N)*m^1)%N # 同底数相乘，指数相加</span><br><span class="line"></span><br><span class="line">=&gt; (m^(K*φ(N)*m)%N</span><br><span class="line"></span><br><span class="line">=&gt; ((m^φ(N)^K%N*m)%N # 幂的乘方，底数不变，指数相乘</span><br><span class="line"></span><br><span class="line">=&gt; ((m^φ(N)^K%N*m%N)%N # (a * b) % p = (a % p * b % p) % p</span><br><span class="line"></span><br><span class="line">=&gt; ((m^φ(N)%N)^K%N*m%N)%N # a ^ b % p = ((a % p) ^ b) % p</span><br><span class="line"></span><br><span class="line">=&gt; (1^K%N*m%N)%N # 根据欧拉定理：a^φ(n)≡1 mod n 即 a^φ(n) mod n = 1</span><br><span class="line"></span><br><span class="line">=&gt; (m%N)%N # 1^K%N=1</span><br><span class="line"></span><br><span class="line">=&gt; (m%N)%N</span><br><span class="line"></span><br><span class="line">=&gt; (m%N)^1%N</span><br><span class="line"></span><br><span class="line">=&gt; (m^1)%N   # a ^ b % p = ((a % p) ^ b) % p</span><br><span class="line"></span><br><span class="line">=&gt; m%N</span><br><span class="line"></span><br><span class="line">m  #因为 m &lt; N</span><br></pre></td></tr></table></figure>
<h1 id="ctf-rsarsa基础题目及脚本"><a class="markdownIt-Anchor" href="#ctf-rsarsa基础题目及脚本">#</a> 【CTF-RSA】RSA 基础题目及脚本</h1>
<h3 id="随机生成flag"><a class="markdownIt-Anchor" href="#随机生成flag">#</a> 随机生成 flag</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import random</span><br><span class="line">import hashlib</span><br><span class="line">import string</span><br><span class="line"></span><br><span class="line">#字符串列表</span><br><span class="line">a=string.printable</span><br><span class="line">#随机生成flag</span><br><span class="line">for i in range(10):</span><br><span class="line">    flag = &quot;&quot;</span><br><span class="line">    for i in range(10):</span><br><span class="line">        flag += a[random.randint(0, 99)]</span><br><span class="line">    flag = hashlib.md5(flag.encode()).hexdigest()</span><br><span class="line">    print(&quot;flag&#123;&quot; + flag + &quot;&#125;&quot;)</span><br><span class="line"></span><br><span class="line">from uuid import uuid1</span><br><span class="line">flag=&quot;flag&#123;&quot;+str(uuid1())+&quot;&#125;&quot;</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<p><img data-src="https://raw.githubusercontent.com/keep212/nima/main/6bb7113e6f3e65e1f762f2565539c32563b340c1.png%40!web-article-pic.avif" alt=""></p>
<h3 id="出题脚本"><a class="markdownIt-Anchor" href="#出题脚本">#</a> 出题脚本</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">#生成随机素数</span><br><span class="line">p=libnum.generate_prime(1024)</span><br><span class="line">q=libnum.generate_prime(1024)</span><br><span class="line">e=65537</span><br><span class="line">m=&quot;flag&#123;20d6e2da95dcc1fa5f5432a436c4be18&#125;&quot;</span><br><span class="line">#字符串转数字</span><br><span class="line">m=libnum.s2n(m)</span><br><span class="line">n=p*q</span><br><span class="line">phi_n=(p-1)*(q-1)</span><br><span class="line">#求逆元</span><br><span class="line">d=libnum.invmod(e,phi_n)</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line"></span><br><span class="line">print(&quot;p=&quot;,p)</span><br><span class="line">print(&quot;q=&quot;,q)</span><br><span class="line">print (&quot;n=&quot;,n)</span><br><span class="line">print(&quot;d=&quot;,d)</span><br><span class="line">print (&quot;e=&quot;,e)</span><br><span class="line">print (&quot;c=&quot;,c) </span><br></pre></td></tr></table></figure>
<p><img data-src="https://raw.githubusercontent.com/keep212/nima/main/d7ebf723ee05575e951a9dcebe6c6e8899e90e93.png%401256w_350h_!web-article-pic.avif" alt=""></p>
<h3 id="已知ndec求m"><a class="markdownIt-Anchor" href="#已知ndec求m">#</a> 已知 n,d,e,c 求 m</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">n= 14685532699024100754723222996385121368294636639693750794149020559314539676501066491415844320990799035552463714403031072164829458702780715523923962246149328887690893262271480633736651143634392056066729487305166335857950659680699210683976952113003674104898343893168719508462975991580551696824510044412974267585312807460664570245139015568859112921920860421973308538800641652781742897528769692264955229878206911313791989518088100099218315995549914435278654377368771668058107642713121127495780090852489015591581414806590111818355121157794129813430710822697558144598815860067978324469091074823400715400666808772858128261149</span><br><span class="line">d= 10655677501818714057545408290692306276248758047017058020876274084213258239416744966450976471246402284779991562186357882946337721435118045765127426899173581894141706933500094886492805160951008521020815528782559085235105783294876017603112074153984218299742602608478449101819428678878037976091306073545785820932796422483686522431260926680891531210950251782422010888047909274618007401655588566411972291526501884077240225819170340160706732901152519829956055255218835518533347875405883278225018714890042991619568316304958478955576005445279807142753050999269866987221510643119355301877102904394259290548609330522059178100989</span><br><span class="line">e= 65537</span><br><span class="line">c= 7937297427288435728721973474925856865675225171317301007619581716746999628275946964127516634203401830643076435690247635478297903236185011960902817030042080567027165802992734580344202744697251074454156026031417427325660809453340428989949816426637434868049018580855865080715251672252410696685286047485204432648545886024276695749435709592994477514818763551176789963387889424072650811645828675090859926233585219662579177051353763021116106877502871331756544361402971459889233069752657661921397258845893293005099736406362733668960163109452223071514272504206470939914043855546880424121530822318600645513435826636440478681928</span><br><span class="line"></span><br><span class="line">m=pow(c, d, n)</span><br><span class="line">print(libnum.n2s(m).decode()) </span><br></pre></td></tr></table></figure>
<p><img data-src="https://raw.githubusercontent.com/keep212/nima/main/78c48eb00ccb1dc84f95ef53eaec99891fa2affc.png%401256w_304h_!web-article-pic.avif" alt=""></p>
<h3 id="已知pqec求m"><a class="markdownIt-Anchor" href="#已知pqec求m">#</a> 已知 p,q,e,c 求 m</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">p= 178974110759313878895493455207516672882434662571655460770401953730906926302476821805659378622536968418528094957044346203494793341636459433763427491907849563922785749794854266865548657682445692416895365631610849027415100889893466490767087266542637440212533807985124840688092762928583845838066174446047886496977</span><br><span class="line">q= 93610871651220602641323046206103959524660743045950590135111801621145944725719667412027010040112514078098465817329474817485502356054795293086881519931215167856745860801666777619204160653243683622930567962804914581845602027547589056026105213437044768786486688576038889017989891165091320977401144724582916902269</span><br><span class="line">e= 65537</span><br><span class="line">c= 10505609204533893330224001468185225454647695615253006709365840521320011117703729471412769493857753605106376689659952882885215696765275778768339621441610719177208351696489476567331875339672513868473669863672226315682278831184868041476134806131989809014422520472566202048041013413698358733781909446846787304422628166599338803127610040714545537436536348608012176828441837378861024372912755344397449657260043057239911064546424582314518819235470388313710641962070846850292694572345451390561142917224092435026246696084949470913298543523893386679712766629009873176804118782436042080621119334193337953451160118095182279971122</span><br><span class="line"></span><br><span class="line">n=p*q</span><br><span class="line">phi_n=(p-1)*(q-1)</span><br><span class="line"></span><br><span class="line">#求逆元</span><br><span class="line">d=libnum.invmod(e,phi_n)</span><br><span class="line"></span><br><span class="line">m=pow(c,d,n)</span><br><span class="line">print(m)</span><br><span class="line">#数字转字节，转字符串</span><br><span class="line">print(libnum.n2s(int(m)).decode()) </span><br></pre></td></tr></table></figure>
<p>![](<span class="exturl" data-url="aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2tlZXAyMTIvbmltYS9tYWluLyVFNSVCMSU4RiVFNSVCOSU5NSVFNiU4OCVBQSVFNSU5QiVCRQ==">https://raw.githubusercontent.com/keep212/nima/main/ 屏幕截图</span> 2024-05-15 140447.png)</p>
<h1 id="ctf-rsa基于n分解的rsa题目"><a class="markdownIt-Anchor" href="#ctf-rsa基于n分解的rsa题目">#</a> 【CTF-RSA】基于 N 分解的 RSA 题目</h1>
<p>对 N 进行分解（只要知道 p 和 q, 就能解出任何 rsa）</p>
<p>N 在有一般情况下不可分解的，如果 p 和 q 太接近，或相差过大，或 pq 很小等情况</p>
<h3 id="1在线查询分解网站"><a class="markdownIt-Anchor" href="#1在线查询分解网站">#</a> 1. 在线查询分解网站</h3>
<p><span class="exturl" data-url="aHR0cDovL3d3dy5mYWN0b3JkYi5jb20vaW5kZXgucGhw">http://www.factordb.com/index.php</span></p>
<h3 id="2使用yafu工具分解"><a class="markdownIt-Anchor" href="#2使用yafu工具分解">#</a> 2. 使用 yafu 工具分解</h3>
<p>下载地址：<span class="exturl" data-url="aHR0cHM6Ly9zb3VyY2Vmb3JnZS5uZXQvcHJvamVjdHMveWFmdS8=">https://sourceforge.net/projects/yafu/</span></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#以分解49为例</span><br><span class="line">yafu-x64.exe factor(49)</span><br><span class="line"></span><br><span class="line">#导入文件进行分解，主要注意文本结尾要换行！！！不然要报错</span><br><span class="line">yafu-x64.exe &quot;factor(@)&quot; -batchfile 1.txt</span><br></pre></td></tr></table></figure>
<h3 id="3使用费马分解"><a class="markdownIt-Anchor" href="#3使用费马分解">#</a> 3. 使用费马分解</h3>
<p>网上找的脚本，p 和 q 太接近</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">def isqrt(n):</span><br><span class="line">  x = n</span><br><span class="line">  y = (x + n // x) // 2</span><br><span class="line">  while y &lt; x:</span><br><span class="line">    x = y</span><br><span class="line">    y = (x + n // x) // 2</span><br><span class="line">  return x</span><br><span class="line"></span><br><span class="line">def fermat(n, verbose=True):</span><br><span class="line">    a = isqrt(n) # int(ceil(n**0.5))</span><br><span class="line">    b2 = a*a - n</span><br><span class="line">    b = isqrt(n) # int(b2**0.5)</span><br><span class="line">    count = 0</span><br><span class="line">    while b*b != b2:</span><br><span class="line">        # if verbose:</span><br><span class="line">        #     print(&#x27;Trying: a=%s b2=%s b=%s&#x27; % (a, b2, b))</span><br><span class="line">        a = a + 1</span><br><span class="line">        b2 = a*a - n</span><br><span class="line">        b = isqrt(b2) # int(b2**0.5)</span><br><span class="line">        count += 1</span><br><span class="line">    p=a+b</span><br><span class="line">    q=a-b</span><br><span class="line">    assert n == p * q</span><br><span class="line">    # print(&#x27;a=&#x27;,a)</span><br><span class="line">    # print(&#x27;b=&#x27;,b)</span><br><span class="line">    # print(&#x27;p=&#x27;,p)</span><br><span class="line">    # print(&#x27;q=&#x27;,q)</span><br><span class="line">    # print(&#x27;pq=&#x27;,p*q)</span><br><span class="line">    return p, q</span><br><span class="line">fermat(n)</span><br></pre></td></tr></table></figure>
<h3 id="4分解出来后用脚本解密即可"><a class="markdownIt-Anchor" href="#4分解出来后用脚本解密即可">#</a> 4. 分解出来后，用脚本解密即可</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">p=</span><br><span class="line">q=</span><br><span class="line">e=</span><br><span class="line">c=</span><br><span class="line"></span><br><span class="line">n=p*q</span><br><span class="line">phi_n=(p-1)*(q-1)</span><br><span class="line"></span><br><span class="line">#求逆元</span><br><span class="line">#d=libnum.invmod(e,phi_n)</span><br><span class="line">d=gmpy2.invert(e,phi_n)</span><br><span class="line"></span><br><span class="line">m=pow(c,d,n)</span><br><span class="line">print(m)</span><br><span class="line">print(libnum.n2s(int(m)).decode())</span><br></pre></td></tr></table></figure>
<h4 id="出题脚本-2"><a class="markdownIt-Anchor" href="#出题脚本-2">#</a> 出题脚本</h4>
<p>p,q 接近，很快就能分解</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">p=libnum.generate_prime(1024)</span><br><span class="line">#下一个素数</span><br><span class="line">q=gmpy2.next_prime(p)</span><br><span class="line">print(p)</span><br><span class="line">print(q)</span><br><span class="line">print(gmpy2.is_prime(q))</span><br><span class="line">e=65537</span><br><span class="line">m=&quot;flag&#123;20d6e2da95dcc1fa5f5432a436c4be18&#125;&quot;</span><br><span class="line">m=libnum.s2n(m)</span><br><span class="line">n=p*q</span><br><span class="line">phi_n=(p-1)*(q-1)</span><br><span class="line">d=libnum.invmod(e,phi_n)</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line"></span><br><span class="line">print(&quot;n=&quot;,n)</span><br><span class="line">print (&quot;e=&quot;,e)</span><br><span class="line">print (&quot;c=&quot;,c)</span><br></pre></td></tr></table></figure>
<p><img data-src="https://raw.githubusercontent.com/keep212/nima/main/afe1675f01cc159684046592319c16cdb6cdda0b.png%401256w_160h_!web-article-pic.avif" alt=""></p>
<h3 id="解题脚本"><a class="markdownIt-Anchor" href="#解题脚本">#</a> 解题脚本</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">import  gmpy2</span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">def isqrt(n):</span><br><span class="line">  x = n</span><br><span class="line">  y = (x + n // x) // 2</span><br><span class="line">  while y &lt; x:</span><br><span class="line">    x = y</span><br><span class="line">    y = (x + n // x) // 2</span><br><span class="line">  return x</span><br><span class="line"></span><br><span class="line">def fermat(n, verbose=True):</span><br><span class="line">    a = isqrt(n) # int(ceil(n**0.5))</span><br><span class="line">    b2 = a*a - n</span><br><span class="line">    b = isqrt(n) # int(b2**0.5)</span><br><span class="line">    count = 0</span><br><span class="line">    while b*b != b2:</span><br><span class="line"></span><br><span class="line">        # if verbose:</span><br><span class="line"></span><br><span class="line">        #     print(&#x27;Trying: a=%s b2=%s b=%s&#x27; % (a, b2, b))</span><br><span class="line"></span><br><span class="line">​        a = a + 1</span><br><span class="line">​        b2 = a*a - n</span><br><span class="line">​        b = isqrt(b2) # int(b2**0.5)</span><br><span class="line">​        count += 1</span><br><span class="line">​    p=a+b</span><br><span class="line">​    q=a-b</span><br><span class="line">​    assert n == p * q</span><br><span class="line"></span><br><span class="line">    # print(&#x27;a=&#x27;,a)</span><br><span class="line"></span><br><span class="line">    # print(&#x27;b=&#x27;,b)</span><br><span class="line"></span><br><span class="line">​    print(&#x27;p=&#x27;,p)</span><br><span class="line">​    print(&#x27;q=&#x27;,q)</span><br><span class="line"></span><br><span class="line">    # print(&#x27;pq=&#x27;,p*q)</span><br><span class="line"></span><br><span class="line">​    return p, q</span><br><span class="line">n= 11236396438945464079176717143196471087880430124798640194523124584883161483744355761881720924798661332027501424643154414538029585287580122761405974427818841257794157497994556608202723391478027760181705924317533420305444809223444128034654367210331137068958693840582892819495487826045956577156074156668942232139402108462349340352898572481115406698318121299787982873916502591396884489682255184448165523604671743400422220149772905676655777228607948091675612455989601008858361759327370403306760674195506394280387024357322586732298060169962426894360775981877169895632927906390632063530920611197753716095903307467004289983267</span><br><span class="line">e= 65537</span><br><span class="line">c= 4260482466101011731957430920901406417434306478040387371588613512063428441001754753741853444857207349755032658064826592770143368278573527632514794087007140974732031358793249329430363014561312271335226315065519570861993052432656879088776144909638480994662696119431870831156129142403063675855781198930583825083362703887688501680905266707624440432914989795886392952354713859444836529227033324455920455610359249535012999943891644938239837207994673190694512955995798836266797112432609992164908679997257920566918693544746179908166741635316261624634351348613130319346356388546672516037747806222134853885202448682842353199133</span><br><span class="line">pq=fermat(n)</span><br><span class="line">p=pq[0]</span><br><span class="line">q=pq[1]</span><br><span class="line">phi_n=(p-1)*(q-1)</span><br><span class="line">#求逆元</span><br><span class="line">#d=libnum.invmod(e,phi_n)</span><br><span class="line">d=gmpy2.invert(e,phi_n)</span><br><span class="line">m=pow(c,d,n)</span><br><span class="line">print(m)</span><br><span class="line">print(libnum.n2s(int(m)).decode()) </span><br></pre></td></tr></table></figure>
<p><img data-src="https://raw.githubusercontent.com/keep212/nima/main/b51e22de0b0d9075a9020c02e6b730570f9d9be4.png%401256w_278h_!web-article-pic.avif" alt=""></p>
<h1 id="ctf-rsarsa密钥生成与读取"><a class="markdownIt-Anchor" href="#ctf-rsarsa密钥生成与读取">#</a> 【CTF-RSA】RSA 密钥生成与读取</h1>
<h2 id="安装pycryptodome模块"><a class="markdownIt-Anchor" href="#安装pycryptodome模块">#</a> 安装 pycryptodome 模块</h2>
<h3 id="公钥生成"><a class="markdownIt-Anchor" href="#公钥生成">#</a> 公钥生成</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line"></span><br><span class="line">p= 787228223375328491232514653709</span><br><span class="line">q= 814212346998672554509751911073</span><br><span class="line">n= 640970939378021470187479083920100737340912672709639557619757</span><br><span class="line">d= 590103645243332826117029128695341159496883001869370080307201</span><br><span class="line">e= 65537</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rsa_components = (n, e)</span><br><span class="line">keypair = RSA.construct(rsa_components)</span><br><span class="line">with open(&#x27;pubckey.pem&#x27;, &#x27;wb&#x27;) as f :</span><br><span class="line">    f.write(keypair.exportKey())</span><br></pre></td></tr></table></figure>
<h3 id="私钥生成"><a class="markdownIt-Anchor" href="#私钥生成">#</a> 私钥生成</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line"></span><br><span class="line">p= 787228223375328491232514653709</span><br><span class="line">q= 814212346998672554509751911073</span><br><span class="line">n= 640970939378021470187479083920100737340912672709639557619757</span><br><span class="line">d= 590103645243332826117029128695341159496883001869370080307201</span><br><span class="line">e= 65537</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rsa_components = (n,e,d,p,q)</span><br><span class="line">keypair = RSA.construct(rsa_components)</span><br><span class="line">with open(&#x27;private1.pem&#x27;, &#x27;wb&#x27;) as f :</span><br><span class="line">    f.write(keypair.exportKey())</span><br></pre></td></tr></table></figure>
<h3 id="公钥读取"><a class="markdownIt-Anchor" href="#公钥读取">#</a> 公钥读取</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line">with open(&quot;pubckey.pem&quot;,&quot;rb&quot;) as f:</span><br><span class="line">    key = RSA.import_key(f.read())</span><br><span class="line">    print(&#x27;n = %d&#x27; % key.n)</span><br><span class="line">    print(&#x27;e = %d&#x27; % key.e)</span><br></pre></td></tr></table></figure>
<h3 id="私钥读取"><a class="markdownIt-Anchor" href="#私钥读取">#</a> 私钥读取</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line">with open(&quot;private1.pem&quot;,&quot;rb&quot;) as f:</span><br><span class="line">    key = RSA.import_key(f.read())</span><br><span class="line">    print(&#x27;n = %d&#x27; % key.n)</span><br><span class="line">    print(&#x27;e = %d&#x27; % key.e)</span><br><span class="line">    print(&#x27;d = %d&#x27; % key.d)</span><br><span class="line">    print(&#x27;p = %d&#x27; % key.p)</span><br><span class="line">    print(&#x27;q = %d&#x27; % key.q)</span><br></pre></td></tr></table></figure>
<h3 id="出题脚本-基于n分解的题目"><a class="markdownIt-Anchor" href="#出题脚本-基于n分解的题目">#</a> 出题脚本 - 基于 N 分解的题目</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line"></span><br><span class="line">p=libnum.generate_prime(1024)</span><br><span class="line">#下一个素数</span><br><span class="line">q=int(gmpy2.next_prime(p))</span><br><span class="line">e=65537</span><br><span class="line">m=&quot;flag&#123;a272722c1db834353ea3ce1d9c71feca&#125;&quot;</span><br><span class="line">m=libnum.s2n(m)</span><br><span class="line">n=p*q</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">flag_c=libnum.n2s(c)</span><br><span class="line">rsa_components = (n, e)</span><br><span class="line">keypair = RSA.construct(rsa_components)</span><br><span class="line">with open(&#x27;pubckey1.pem&#x27;, &#x27;wb&#x27;) as f :</span><br><span class="line">    f.write(keypair.exportKey())</span><br><span class="line">with open(&quot;flag.txt&quot;,&quot;wb&quot;) as f:</span><br><span class="line">    f.write(flag_c)</span><br></pre></td></tr></table></figure>
<p><img data-src="https://raw.githubusercontent.com/keep212/nima/main/335173d5bac49444e1ea16dd80a587d2e0dcbf93.png%401256w_468h_!web-article-pic.avif" alt=""></p>
<p><img data-src="https://raw.githubusercontent.com/keep212/nima/main/bedadfdad9bcba50f4c7ed4dd4a96ff4811dd61b.png%401256w_192h_!web-article-pic.avif" alt=""></p>
<h3 id="解题脚本-2"><a class="markdownIt-Anchor" href="#解题脚本-2">#</a> 解题脚本</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def isqrt(n):</span><br><span class="line">  x = n</span><br><span class="line">  y = (x + n // x) // 2</span><br><span class="line">  while y &lt; x:</span><br><span class="line">    x = y</span><br><span class="line">    y = (x + n // x) // 2</span><br><span class="line">  return x</span><br><span class="line"></span><br><span class="line">def fermat(n, verbose=True):</span><br><span class="line">    a = isqrt(n) # int(ceil(n**0.5))</span><br><span class="line">    b2 = a*a - n</span><br><span class="line">    b = isqrt(n) # int(b2**0.5)</span><br><span class="line">    count = 0</span><br><span class="line">    while b*b != b2:</span><br><span class="line">        # if verbose:</span><br><span class="line">        #     print(&#x27;Trying: a=%s b2=%s b=%s&#x27; % (a, b2, b))</span><br><span class="line">        a = a + 1</span><br><span class="line">        b2 = a*a - n</span><br><span class="line">        b = isqrt(b2) # int(b2**0.5)</span><br><span class="line">        count += 1</span><br><span class="line">    p=a+b</span><br><span class="line">    q=a-b</span><br><span class="line">    assert n == p * q</span><br><span class="line">    # print(&#x27;a=&#x27;,a)</span><br><span class="line">    # print(&#x27;b=&#x27;,b)</span><br><span class="line">    # print(&#x27;p=&#x27;,p)</span><br><span class="line">    # print(&#x27;q=&#x27;,q)</span><br><span class="line">    # print(&#x27;pq=&#x27;,p*q)</span><br><span class="line">    return p, q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">with open(&quot;pubckey1.pem&quot;,&quot;rb&quot;) as f:</span><br><span class="line">    key = RSA.import_key(f.read())</span><br><span class="line">    n=key.n</span><br><span class="line">    e=key.e</span><br><span class="line"></span><br><span class="line">with open(&quot;flag.txt&quot;,&quot;rb&quot;) as f:</span><br><span class="line">    c=f.read()</span><br><span class="line">    c=libnum.s2n(c)</span><br><span class="line"></span><br><span class="line">#费马分解,</span><br><span class="line">n1=fermat(n)</span><br><span class="line">p=n1[0]</span><br><span class="line">q=n1[1]</span><br><span class="line">phi_n=(p-1)*(q-1)</span><br><span class="line">#求逆元</span><br><span class="line">d=libnum.invmod(e,phi_n)</span><br><span class="line">m=pow(c,d,n)</span><br><span class="line">print(m)</span><br><span class="line">print(libnum.n2s(int(m)).decode())</span><br></pre></td></tr></table></figure>
<p><img data-src="https://raw.githubusercontent.com/keep212/nima/main/1989cf5f79a4a51208c0ba623d1290f5c9cff21c.png%40!web-article-pic.avif" alt=""></p>
<h3 id="进阶自动生成密钥及加解密"><a class="markdownIt-Anchor" href="#进阶自动生成密钥及加解密">#</a> 进阶 —— 自动生成密钥及加解密</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Cipher import PKCS1_v1_5</span><br><span class="line">from Crypto import Random</span><br><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line">from Crypto.Cipher import PKCS1_OAEP</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">random_generator = Random.new().read</span><br><span class="line">rsa = RSA.generate(2048, random_generator)</span><br><span class="line"># 生成私钥</span><br><span class="line">private_key = rsa.exportKey()</span><br><span class="line"># print(private_key.decode(&#x27;utf-8&#x27;))</span><br><span class="line">with open(&#x27;rsa_private_key.pem&#x27;, &#x27;wb&#x27;)as f:</span><br><span class="line">    f.write(private_key)</span><br><span class="line"># 生成公钥</span><br><span class="line">public_key = rsa.publickey().exportKey()</span><br><span class="line"># print(public_key.decode(&#x27;utf-8&#x27;))</span><br><span class="line">with open(&#x27;rsa_public_key.pem&#x27;, &#x27;wb&#x27;)as f:</span><br><span class="line">    f.write(public_key)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#测试用密钥加密</span><br><span class="line">public_key = RSA.importKey(public_key)</span><br><span class="line">msg=&#x27;flag&#x27;</span><br><span class="line">pk = PKCS1_v1_5.new(public_key)</span><br><span class="line">encrypt_text = pk.encrypt(msg.encode())</span><br><span class="line">print(encrypt_text)</span><br><span class="line"></span><br><span class="line">#测试密钥解密</span><br><span class="line">private_key = RSA.importKey(private_key)</span><br><span class="line">pk = PKCS1_v1_5.new(private_key)</span><br><span class="line">msg = pk.decrypt(encrypt_text,0)</span><br><span class="line">print(msg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#两种标准</span><br><span class="line">rsa_components = (n, e, int(d), p, q)</span><br><span class="line">arsa = RSA.construct(rsa_components)</span><br><span class="line">rsakey = RSA.importKey(arsa.exportKey())</span><br><span class="line">rsakey = PKCS1_OAEP.new(rsakey)</span><br><span class="line">decrypted = rsakey.decrypt(c)</span><br><span class="line">print(decrypted)</span><br></pre></td></tr></table></figure>
<h1 id="ctf-rsa共模攻击脚本"><a class="markdownIt-Anchor" href="#ctf-rsa共模攻击脚本">#</a> 【CTF-RSA】共模攻击脚本</h1>
<p><img data-src="https://raw.githubusercontent.com/keep212/nima/main/ec5eb5692b3dec285a513ca7ce945dbaa4eedb00.png%401256w_354h_!web-article-pic.avif" alt=""></p>
<h3 id="出题脚本-3"><a class="markdownIt-Anchor" href="#出题脚本-3">#</a> 出题脚本</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">coding:utf-8</span><br><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line">#生成素数</span><br><span class="line">p=libnum.generate_prime(1024)</span><br><span class="line">q=libnum.generate_prime(1024)</span><br><span class="line">e1=2333</span><br><span class="line">e2=23333</span><br><span class="line">m=&quot;flag&#123;6ed4c74e022cb18c8039e96de93aa9ce&#125;&quot;</span><br><span class="line">m=libnum.s2n(m)</span><br><span class="line">n=p*q</span><br><span class="line">c1=pow(m,e1,n)</span><br><span class="line">c2=pow(m,e2,n)</span><br><span class="line">print(&quot;n1=&quot;,n)</span><br><span class="line">print(&quot;e1=&quot;,e1)</span><br><span class="line">print(&quot;c1=&quot;,c1)</span><br><span class="line">print(&quot;n2=&quot;,n)</span><br><span class="line">print(&quot;e2=&quot;,e2)</span><br><span class="line">print(&quot;c2=&quot;,c2)</span><br></pre></td></tr></table></figure>
<p><img data-src="https://raw.githubusercontent.com/keep212/nima/main/fa8f24b2218ffda191d24a04e651d113340c096e.png%401256w_370h_!web-article-pic.avif" alt=""></p>
<h3 id="解密脚本"><a class="markdownIt-Anchor" href="#解密脚本">#</a> 解密脚本</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#coding:utf-8</span><br><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">n= 25333966058003377512707481338795714713737652659944601834182685873529702913988641983855700459996104700470621411559153944988952210084014634675583566338568882440708528997808798650962116756969822211586531522430245040013570571043385238601846104615050089457836721437790715225367971106085839523500735480715155424498941150468093083816830215632716244390679417218873179734276657411907216486790815037105108306055794473002315541787461904728375164737225486501009857299717749346279371251245318729951905832578739696926931502225899707226264570557623527701806829827566904224572897378639191756878049342203546309520458672464170859577433</span><br><span class="line">e1= 2333</span><br><span class="line">c1= 11355981897781478907853356911752561659125575027336719997290835661089901154031171698660586203170528368228850895159361637188990782030255983633790580700032092629587631108597144196551438410868034739981960656110887650747325311613900008001234835897835613759692146419080113176963747835592656185435741504176116672174539018089139547795447109458469225330809064539216773123671814859510069089532677704482026169178543062578686794346026774853085101278125763460212801929360456888869350105294595904940799522522144740464043605342348269086324747729288399275079874271519208155039364092577755518532799345651172433227745483422620900776136</span><br><span class="line">e2= 23333</span><br><span class="line">c2= 1326499538902841116411674554069945581390130048432351353260154261863309471312810811160302458644816390944833633923435634961251092531893503039914793217247984595331920909367627316087404934402312358642315675486438968585084964845763881078835787872160374025547400141298650794551970291119975344578667689961134814676553190178139842507675899262024572370313939107080072875068218336255452161407859907308656094331557912187788276334833723893856310434523337557011032081467262457427167978528280339494077785813461280853735266463152709443731638714219391773144349752633555310299318290576258086971373777118482642702020599928071855133041</span><br><span class="line"></span><br><span class="line">#共模攻击</span><br><span class="line">#共模攻击函数</span><br><span class="line">def rsa_gong_N_def(e1,e2,c1,c2,n):</span><br><span class="line">    e1, e2, c1, c2, n=int(e1),int(e2),int(c1),int(c2),int(n)</span><br><span class="line">    s = gmpy2.gcdext(e1, e2)</span><br><span class="line">    s1 = s[1]</span><br><span class="line">    s2 = s[2]</span><br><span class="line">    if s1 &lt; 0:</span><br><span class="line">        s1 = - s1</span><br><span class="line">        c1 = gmpy2.invert(c1, n)</span><br><span class="line">    elif s2 &lt; 0:</span><br><span class="line">        s2 = - s2</span><br><span class="line">        c2 = gmpy2.invert(c2, n)</span><br><span class="line">    m = (pow(c1,s1,n) * pow(c2 ,s2 ,n)) % n</span><br><span class="line">    return int(m)</span><br><span class="line">m = rsa_gong_N_def(e1,e2,c1,c2,n)</span><br><span class="line">print(m)</span><br><span class="line">print(libnum.n2s(int(m)))</span><br></pre></td></tr></table></figure>
<p><img data-src="https://raw.githubusercontent.com/keep212/nima/main/db1d26321464b070f47f0a1977de7ecb752ae6eb.png%401256w_230h_!web-article-pic.avif" alt=""></p>
<h3 id="共模攻击原理"><a class="markdownIt-Anchor" href="#共模攻击原理">#</a> 共模攻击原理</h3>
<p>两个及以上的公钥 (n,e) 来加密同一条信息 m</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c1 = pow(m, e1, n)</span><br><span class="line">c2 = pow(m, e2, n)</span><br></pre></td></tr></table></figure>
<p>e1，e2 互质，则有</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcd(e1,e2)=1</span><br></pre></td></tr></table></figure>
<p>根据扩展欧几里德算法 对于不完全为 0 的整数 a，b，gcd（a，b）表示 a，b 的最大公约数。那么一定存在整数 x，y 使得 gcd（a，b）=ax+by</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e1*s1+e2*s2 = 1</span><br></pre></td></tr></table></figure>
<p>s1、s2 皆为整数，但是一正一负，假设 s1 为正数，s2 为负数</p>
<p>因为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c1 = m^e1%n</span><br><span class="line">c2 = m^e2%n</span><br></pre></td></tr></table></figure>
<p>可得：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(c1^s1*c2^s2)%n = ((m^e1%n)^s1(m^e2%n)^s2)%n</span><br></pre></td></tr></table></figure>
<p>根据模运算性质： 幂运算是一种关于幂的数学运算。同底数幂相乘，底数不变，指数相加。同底数幂相除，底数不变，指数相减。幂的乘方，底数不变，指数相乘。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(a * b) % p = (a % p * b % p) % p</span><br><span class="line">a ^ b % p = ((a % p) ^ b) % p</span><br></pre></td></tr></table></figure>
<p>简化公式为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(c1^s1*c2^s2)%n = ((m^e1%n)^s1*(m^e2%n)^s2)%n</span><br><span class="line"></span><br><span class="line">=&gt; (c1^s1*c2^s2)%n = ((m^e1%n)^s1%n*(m^e2%n)^s2%n)%n #(a * b) % p = (a % p * b % p) % p</span><br><span class="line"></span><br><span class="line">=&gt; (c1^s1*c2^s2)%n = ((m^e1)^s1%n*(m^e2)^s2%n)%n #((a % p) ^ b) % p =a ^ b % p</span><br><span class="line"></span><br><span class="line">=&gt; (c1^s1*c2^s2)%n = ((m^e1)^s1*(m^e2)^s2)%n # (a % p * b % p) % p=(a * b) % p</span><br><span class="line"></span><br><span class="line">=&gt;(c1^s1*c2^s2)%n = ((m^(e1*s1)*(m^(e2*s2))%n #。幂的乘方，底数不变，指数相乘。</span><br><span class="line"></span><br><span class="line">(c1^s1*c2^s2)%n = (m^(e1*s1+e2*s2))%n  # 同底数幂相乘，底数不变，指数相加。</span><br></pre></td></tr></table></figure>
<p>因为 e1<em>s1+e2</em>s2 = 1 得：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(c1^s1*c2^s2)%n = (m^1)%n</span><br><span class="line"></span><br><span class="line">(c1^s1*c2^s2）%n=m</span><br></pre></td></tr></table></figure>
<p>上述就是 rsa 共模攻击的过程</p>
<p>因此，同一 m，同一 n, 不同 e，进行加密。在不需要知道 d 的情况下，可以进行解密。</p>
<h1 id="ctf-rsawiener维纳攻击脚本"><a class="markdownIt-Anchor" href="#ctf-rsawiener维纳攻击脚本">#</a> 【CTF-RSA】wiener (维纳) 攻击脚本</h1>
<p>低解密指数攻击</p>
<p>维纳攻击:e 指数很大 (理论上 d&lt;N**0.25 此攻击起作用)</p>
<h3 id="出题脚本-4"><a class="markdownIt-Anchor" href="#出题脚本-4">#</a> 出题脚本</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import random</span><br><span class="line">import gmpy2</span><br><span class="line">#生成随机素数</span><br><span class="line">p=libnum.generate_prime(512)</span><br><span class="line">q=libnum.generate_prime(512)</span><br><span class="line">m=&quot;flag&#123;20d6e2da95dcc1fa5f5432a436c4be18&#125;&quot;</span><br><span class="line">#字符串转数字</span><br><span class="line">m=libnum.s2n(m)</span><br><span class="line">n=p*q</span><br><span class="line">phi_n=(p-1)*(q-1)</span><br><span class="line">#计算d</span><br><span class="line">while True:</span><br><span class="line">    nbits=1024</span><br><span class="line">    d = random.getrandbits(nbits // 4)</span><br><span class="line">    if (libnum.gcd(d, phi_n) == 1 and 36 * pow(d, 4) &lt; n):</span><br><span class="line">        break</span><br><span class="line">#计算e</span><br><span class="line">e = libnum.invmod(d,phi_n)</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print (&quot;n=&quot;,n)</span><br><span class="line">print (&quot;e=&quot;,e)</span><br><span class="line">print (&quot;c=&quot;,c)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">输出</span><br><span class="line">n=102099548361332638344237630396918304669480123432427691789000801421929226904417516565900645418525797159668929644513100700481417366819546101164265596706858513650095068198188946822981224172023933260431303286767867370050964230357219983386055508144712031982008096516285393789767140630413556460318866725444111200943</span><br><span class="line">e=94994203498929475603874878316562406769119091464658088508285677241091060748158032542307067657105896639464248805968843801720116349229945077164078734338861088173913967531166751856585737460477446495550234322955763049253862441121077805134024431490817802775319606751537898284798700294616843500662903168724602836801</span><br><span class="line">c=81573644335666712672791855949066359386986007425938431546920059710780388358488503125182517117627957949413515274338734396361948242477931901530434398164748401317943265396004901457700820503669867532428599683112699749720514979210181537932231600377359054106599204293139340781914077341382222025122079086888130243607</span><br></pre></td></tr></table></figure>
<h3 id="解题脚本-3"><a class="markdownIt-Anchor" href="#解题脚本-3">#</a> 解题脚本</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">def continuedFra(x, y):</span><br><span class="line">    &quot;&quot;&quot;计算连分数</span><br><span class="line">    :param x: 分子</span><br><span class="line">    :param y: 分母</span><br><span class="line">    :return: 连分数列表</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    cf = []</span><br><span class="line">    while y:</span><br><span class="line">        cf.append(x // y)</span><br><span class="line">        x, y = y, x % y</span><br><span class="line">    return cf</span><br><span class="line">def gradualFra(cf):</span><br><span class="line">    &quot;&quot;&quot;计算传入列表最后的渐进分数</span><br><span class="line">    :param cf: 连分数列表</span><br><span class="line">    :return: 该列表最后的渐近分数</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    numerator = 0</span><br><span class="line">    denominator = 1</span><br><span class="line">    for x in cf[::-1]:</span><br><span class="line">        # 这里的渐进分数分子分母要分开</span><br><span class="line">        numerator, denominator = denominator, x * denominator + numerator</span><br><span class="line">    return numerator, denominator</span><br><span class="line">def solve_pq(a, b, c):</span><br><span class="line">    &quot;&quot;&quot;使用韦达定理解出pq，x^2−(p+q)∗x+pq=0</span><br><span class="line">    :param a:x^2的系数</span><br><span class="line">    :param b:x的系数</span><br><span class="line">    :param c:pq</span><br><span class="line">    :return:p，q</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    par = gmpy2.isqrt(b * b - 4 * a * c)</span><br><span class="line">    return (-b + par) // (2 * a), (-b - par) // (2 * a)</span><br><span class="line">def getGradualFra(cf):</span><br><span class="line">    &quot;&quot;&quot;计算列表所有的渐近分数</span><br><span class="line">    :param cf: 连分数列表</span><br><span class="line">    :return: 该列表所有的渐近分数</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    gf = []</span><br><span class="line">    for i in range(1, len(cf) + 1):</span><br><span class="line">        gf.append(gradualFra(cf[:i]))</span><br><span class="line">    return gf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def wienerAttack(e, n):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    :param e:</span><br><span class="line">    :param n:</span><br><span class="line">    :return: 私钥d</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    cf = continuedFra(e, n)</span><br><span class="line">    gf = getGradualFra(cf)</span><br><span class="line">    for d, k in gf:</span><br><span class="line">        if k == 0: continue</span><br><span class="line">        if (e * d - 1) % k != 0:</span><br><span class="line">            continue</span><br><span class="line">        phi = (e * d - 1) // k</span><br><span class="line">        p, q = solve_pq(1, n - phi + 1, n)</span><br><span class="line">        if p * q == n:</span><br><span class="line">            return d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n=102099548361332638344237630396918304669480123432427691789000801421929226904417516565900645418525797159668929644513100700481417366819546101164265596706858513650095068198188946822981224172023933260431303286767867370050964230357219983386055508144712031982008096516285393789767140630413556460318866725444111200943</span><br><span class="line">e=94994203498929475603874878316562406769119091464658088508285677241091060748158032542307067657105896639464248805968843801720116349229945077164078734338861088173913967531166751856585737460477446495550234322955763049253862441121077805134024431490817802775319606751537898284798700294616843500662903168724602836801</span><br><span class="line">c=81573644335666712672791855949066359386986007425938431546920059710780388358488503125182517117627957949413515274338734396361948242477931901530434398164748401317943265396004901457700820503669867532428599683112699749720514979210181537932231600377359054106599204293139340781914077341382222025122079086888130243607</span><br><span class="line"></span><br><span class="line">d=wienerAttack(e, n)</span><br><span class="line">m=pow(c, d, n)</span><br><span class="line">print(libnum.n2s(m).decode())</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;20d6e2da95dcc1fa5f5432a436c4be18&#125;</span><br></pre></td></tr></table></figure>
<h1 id="ctf-rsa低加密指数攻击"><a class="markdownIt-Anchor" href="#ctf-rsa低加密指数攻击">#</a> 【CTF-RSA】低加密指数攻击</h1>
<p>加密指数指的是 e，e 一般选取 65535，当 e 很小，可直接破解。</p>
<p>这类攻击在 CTF 题中，一般是 e=3</p>
<p>如果 e = 3，且 m^e &lt; n，c 开 3 次根式，得到 m。</p>
<p>如果 e = 3 ，且 m^e &gt; n，那么设 k，有:c = m^e +kn</p>
<p>爆破 k，如果 c - kn 能开三次根式，得到 m。</p>
<h3 id="出题脚本-5"><a class="markdownIt-Anchor" href="#出题脚本-5">#</a> 出题脚本</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">#生成随机素数</span><br><span class="line">p=libnum.generate_prime(1024)</span><br><span class="line">q=libnum.generate_prime(1024)</span><br><span class="line">e=3</span><br><span class="line">m=&quot;flag&#123;20d6e2da95dcc1fa5f5432a436c4be18&#125;&quot;</span><br><span class="line">#字符串转数字</span><br><span class="line">m=libnum.s2n(m)</span><br><span class="line">n=p*q</span><br><span class="line">phi_n=(p-1)*(q-1)</span><br><span class="line">#求逆元</span><br><span class="line">d=gmpy2.invert(e,phi_n)</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line"></span><br><span class="line">print (&quot;n=&quot;,n)</span><br><span class="line">print (&quot;e=&quot;,e)</span><br><span class="line">print (&quot;c=&quot;,c)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">n=18361906160620022464979295059548883385156763943394380833201208639301999608709114912270056929331270217554369812335058385974338512141859324983921470930958736360738390027166728364010907401951540109944793784157080984583656592972723810889149243441868648226149805798535282656161928879613643809863794073478884041202910160124060619201573772596307101846646211547036087826821419144901484859844669828292496176238256415692144872092048438977709004772671999206253947138558324768798764429817036656232137523183071900974937071243387207692734022115048640542690719058701296145264383203094482976978127329751006501499156643644516658977039</span><br><span class="line">e= 3</span><br><span class="line">c=2217344750798294937344050117513831761010547351781457575945714176628679412650463329423466955026804439931765627111856888102133234836914006818023839994342283023142702993182665344445325734299047409223354338948863171846780674244925724334091153701697864918695050507247415283070309</span><br></pre></td></tr></table></figure>
<h3 id="解题脚本-4"><a class="markdownIt-Anchor" href="#解题脚本-4">#</a> 解题脚本</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">def de(c, e, n):</span><br><span class="line">    k = 0</span><br><span class="line">    while True:</span><br><span class="line">        mm = c + n*k</span><br><span class="line">        result, flag = gmpy2.iroot(mm, e)</span><br><span class="line">        if True == flag:</span><br><span class="line">            return result</span><br><span class="line">        k += 1</span><br><span class="line">n=18361906160620022464979295059548883385156763943394380833201208639301999608709114912270056929331270217554369812335058385974338512141859324983921470930958736360738390027166728364010907401951540109944793784157080984583656592972723810889149243441868648226149805798535282656161928879613643809863794073478884041202910160124060619201573772596307101846646211547036087826821419144901484859844669828292496176238256415692144872092048438977709004772671999206253947138558324768798764429817036656232137523183071900974937071243387207692734022115048640542690719058701296145264383203094482976978127329751006501499156643644516658977039</span><br><span class="line">e= 3</span><br><span class="line">c=2217344750798294937344050117513831761010547351781457575945714176628679412650463329423466955026804439931765627111856888102133234836914006818023839994342283023142702993182665344445325734299047409223354338948863171846780674244925724334091153701697864918695050507247415283070309</span><br><span class="line"></span><br><span class="line">m=de(c,e,n)</span><br><span class="line">print(m)</span><br><span class="line">print(libnum.n2s(int(m)).decode())</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;20d6e2da95dcc1fa5f5432a436c4be18&#125;</span><br></pre></td></tr></table></figure>
<h1 id="ctf-rsa低加密指数广播攻击"><a class="markdownIt-Anchor" href="#ctf-rsa低加密指数广播攻击">#</a> 【CTF-RSA】低加密指数广播攻击</h1>
<p>如果选取的加密指数较低，并且使用了相同的加密指数给一个接受者的群发送相同的信 息，那么可以进行广播攻击得到明文。</p>
<p>在 CTF 中，n、 c 不同，明文 m， e 相同，其 e 比较小。使用中国剩余定理求解</p>
<h3 id="出题脚本-6"><a class="markdownIt-Anchor" href="#出题脚本-6">#</a> 出题脚本</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">#生成随机素数</span><br><span class="line">def rsa_def(e,m):</span><br><span class="line">    p=libnum.generate_prime(1024)</span><br><span class="line">    q=libnum.generate_prime(1024)</span><br><span class="line">    #字符串转数字</span><br><span class="line">    m=libnum.s2n(m)</span><br><span class="line">    n=p*q</span><br><span class="line">    c=pow(m,e,n)</span><br><span class="line">    n_lt.append(n)</span><br><span class="line">    c_lt.append(c)</span><br><span class="line"></span><br><span class="line">n_lt=[]</span><br><span class="line">c_lt=[]</span><br><span class="line">e=23</span><br><span class="line">m=&#x27;flag&#123;2cb2eb4b2c7fdf4e94e10344be856446&#125;&#x27;</span><br><span class="line">for i in range(7):</span><br><span class="line">    rsa_def(e,m)</span><br><span class="line"></span><br><span class="line">print(&quot;e=&quot;,e)</span><br><span class="line">print(&quot;n=&quot;,n_lt)</span><br><span class="line">print(&quot;c=&quot;,c_lt)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">e= 23</span><br><span class="line">n= [28303622412582000131021407474534006627921799223355183106077505407831206380301837802779082885240206111505508547474437431362756095431762358110052438004267595363538307523189378160064363522004491855944919119597205658182749902342637937883927268605382518011199700158912849626569207674748509433787195694903010718581029837747981171596866887181030964844788562253129379797530253580033726662830283337751897717068387389316332038495989183875297434865972913656079980895151344185488446963115671720552088880147981915346363110130965930170755630143071342168860938247998306451689613273637151748431977358920444034764161368269864228260683, 20251452587759389751052720079014998244267616359016633593589175521621218456216360455295414295294412150809772398298894292213274346026242406070081445287045202845357692424984414731052455823237307016241779223277378745608301817094614950269964820345061379221697200410141112889155488951350825981000289053073683521941913801494200697246114178401082071562438086829634844209636507018099598320310860622688713956769159252262767722969006737392560062259268529057175218726693282184813651015664791336482617886917300606453413316038320561235717486917130822910721442930492265275565223486795987687552720234029811300311632264662984617939923, 14346699094920477306010014637065577396695146335017849885453710192053891302468843510448258124074965535071629427969248410027905493732280558837459311032388092215070142163153478283674348594955980639353521355441745601559314424603582895058504836475536927137989360726605508903641768784888818544654282487163986929656604018129571142512687134510041787214732147219138074791325301979785700412656267988690767850022868346773574953938614889361051066241822201821473385327983954592011097734422105185886881113996631236580465724811634148336929200213266140831603665217513011608681717494792540922272443225320166269546005384086341666270237, 20666343363156785654985613960098447088558685398640350288254320340496666688516590319064027915211047314924250684432033752242942966685842979794980296365888247039788491929724979065867747495180389495328018143172137761614969040970809046901475911809919819225814792921474015886234384233024615479366352095594442693243266913593735671556255730133253641239650968425165554567952946701451909296290474332348774876523488586367522569297383954521921027624472179940907798879661735838019525520096563628175856915838339369924996762439573028482405388108352766763640977505904313025884575825285855552752229632152736769500408011313183214392153, 14480286280129696514270349363639135690194813767915498959160314284345452109136054438918279879687988685577041179672481826413238969577366809496037008028319471115982075204004599853880859319285735251215720017350744902158301356474516391525891691871856049412845949704986820012935591952822443217869963788393612548023802605993419800696221415244404127247038175359086885939193086585037732169908522678773825469337954376145864799261157893957600692457882657459928699280090202008141189229552755119857595139897657107729811724161618369203527263317202234130089849201954557040754721260368951656599885121453704835178188315313686147051923, 25135420084057729138962207770153147249216029716010916549133072798022173651499205043606282483768583672328760981332426505696227594660119754631421070583142367295963352819026044721993905256646249896759721623276462449809859752925530184188042885144607718530989588516038414786694143648547597489366540402541899809051752326713817126431123487448396593702877775626937606471335455786422703851710737764866288332272933341502968739417462132708542330342772267969202023083086220041463278283077205795088208728884309357563743034975287256152505174426461145926368526423625546487258149118398734494641732919040020011403436393212191779432673, 14170383666109427589521313589398954693073999267690679429232942135812456809241794890000695435122337549594511547359442056505587452722540626257265898140591417773350910678019484155053006149919493857135172612823857432437751164396086806969247887722030626100150488635591461262100283389559941169785826738781070083631000931652943447440214092308220562550698836331050228146220398533720225203000322816574801344359625600962347408643059867457659818853613771081585704280121043234667995329377274986249499236061703041940482592689369088929027039513948760377275611911167035304174744652049727637136905531242917152702461696223811033602849]</span><br><span class="line">c= [15173807047472256447845684717251358912200122697842932385546098349809093752333910920794395969740005443648644569649151629387591807920298558650496538425219132987551223405408877632454158688064537658192460658356150057322506966948335987016028449001715452265499461776374053182409407643957629092529093158637338071846233068554991170358967852459399326506707061476129428800423426317404552334777482684000352415432732181431121500596157289667232882302431654245553236480148739150161235082097663476820421720676277364383804753596422154646210167713035821889664523396840593631837829893992707455057905959892044493550616949765027220821785, 11938220729710468926557967838524738768470825644612868603230757095292323093455865828959914062879644655551785832471143737493581841344185257107375234777532911128608967712481626952843271008996247807352342523498164298300504938844670197912254303803381691946636195711489073144969303997622633132286422880867271226194190255544078235550661988616892022747818310141637456428313681765661471975562221216381338670295432045738683059404018667138703833764008763778236536867798296840402557891175517847355068530786232834297244608865178392836134797580251614936231688236439984467175534272554294756436715223184842969069377142090754306086587, 8372259615196673779309934993544198416663757780787798713946610637626427463845006237283078696569258480955022027747227029707234987550305246888247136777153012680650117836880636761607863194764822189962747464025510178303075209848879650377247816192817842261342129001268715009974847247605278255193595427547890570752506772700910884836219465705104991007024562594310924752843471782461218371258698746171751166701903238716161531339945132602715536032022798223230723435175807913796348676823846038302524566716088962679362404006745480422576452325081934683229769895346449322176285464821570547521826791307002350786334042239662645563957, 5733976274584604503158989659243088656260484646101064598377820249243214941836104198790082691176209885137416348787627889019963374849716526301643203575745466143947067545186455524140490976182048095864032981061075827442834540637189552464126900919432241265888539704207825612690608583372413157779228956416948469330266827436190056447128563728081276323274058344982585240713393646248729347606147217955847165489399173144936327439947001621504890772515826043945534422085396820828587397025376566166372721369230275346318899064967181577034570239626240177509679081760324839630754365907895622832683887937718999018391437954527915504901, 11962620418277676374646808244354446889608161479405151063272409866849868879538467999438518866434088322058589141374532978662604437111947985330191441627067325730811388148805199455276493437021336994786423781063493329839484836248757775950256990830760793068417392697398710960950052662407124826751941922179917894234165713413459177376070935878803205790872796797683585051588692549376205056943215230738458048997617777633513907061623849828839043504459133638367820741574829044986070351587722416355383246077069665269193960717664499012759258851692437332541468322361668893398759490048718179565240789060484618800904819752877790839865, 14514190627252965989458912133650177358276024599448353767974956651001711285954527380677271379264744774560583389294677415329151572066496871191623403237537474484131590211694780397994927633637859321564626876861928816731833317835860346102068049048681141741602880112650970773766475860379331822623866557451204868940771037743371956603238411685645585455864559001752753943194800979965196045576484095541094062989278859774751950753918707697030394009501569165004933027458740532191312977538863175872726905565882031876620249853780381000852597492112187214600432630583588524386583025190254266601054787278440312207823089175947291805412, 7170711933239761804272372742798978256972824803609483931621008487728643522487624210005513129465353379861752443367806850891359310644714068239910036947843884154622114312629119056999639223587198702912932135706473355115493813596396494080029186640406895454294620829968679709936590321511385222821447179694303480562868112280011278299778419343863090503526288120666396481735329192528853631884136207219752754405396833982641885684715010162118882211883389908927141918526128685468851895086930506025457622185661218790174083864969366351390048046735613504180183923456680037579550089548742296821712544283816875194625748204510190006748]</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="解密脚本-2"><a class="markdownIt-Anchor" href="#解密脚本-2">#</a> 解密脚本</h3>
<h4 id="解密脚本1"><a class="markdownIt-Anchor" href="#解密脚本1">#</a> 解密脚本 1</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">from gmpy2 import invert, gcd, iroot</span><br><span class="line"></span><br><span class="line">def op(x):</span><br><span class="line">    res = 1</span><br><span class="line">    for i in x:</span><br><span class="line">        res *= i</span><br><span class="line">    return res</span><br><span class="line"></span><br><span class="line">def CRT(m, a):</span><br><span class="line">    assert (len(m) == len(a))</span><br><span class="line">    M = op(m)</span><br><span class="line">    sum = 0</span><br><span class="line">    for m, a in zip(m, a):</span><br><span class="line">        Mi = M // m</span><br><span class="line">        ti = invert(Mi, m)</span><br><span class="line">        sum += a * ti * Mi</span><br><span class="line">    return sum % M</span><br><span class="line">def GCRT(m, a):</span><br><span class="line">    assert (len(m) == len(a))</span><br><span class="line">    curm, cura = m[0], a[0]</span><br><span class="line">    for m, a in zip(m[1:], a[1:]):</span><br><span class="line">        d = gcd(curm, m)</span><br><span class="line">        c = a - cura</span><br><span class="line">        assert (c % d == 0)</span><br><span class="line">        K = c // d * invert(curm // d, m // d)</span><br><span class="line">        cura += curm * K</span><br><span class="line">        curm = curm * m // d</span><br><span class="line">    return cura % curm</span><br><span class="line"></span><br><span class="line">e= 23</span><br><span class="line">n= [28303622412582000131021407474534006627921799223355183106077505407831206380301837802779082885240206111505508547474437431362756095431762358110052438004267595363538307523189378160064363522004491855944919119597205658182749902342637937883927268605382518011199700158912849626569207674748509433787195694903010718581029837747981171596866887181030964844788562253129379797530253580033726662830283337751897717068387389316332038495989183875297434865972913656079980895151344185488446963115671720552088880147981915346363110130965930170755630143071342168860938247998306451689613273637151748431977358920444034764161368269864228260683, 20251452587759389751052720079014998244267616359016633593589175521621218456216360455295414295294412150809772398298894292213274346026242406070081445287045202845357692424984414731052455823237307016241779223277378745608301817094614950269964820345061379221697200410141112889155488951350825981000289053073683521941913801494200697246114178401082071562438086829634844209636507018099598320310860622688713956769159252262767722969006737392560062259268529057175218726693282184813651015664791336482617886917300606453413316038320561235717486917130822910721442930492265275565223486795987687552720234029811300311632264662984617939923, 14346699094920477306010014637065577396695146335017849885453710192053891302468843510448258124074965535071629427969248410027905493732280558837459311032388092215070142163153478283674348594955980639353521355441745601559314424603582895058504836475536927137989360726605508903641768784888818544654282487163986929656604018129571142512687134510041787214732147219138074791325301979785700412656267988690767850022868346773574953938614889361051066241822201821473385327983954592011097734422105185886881113996631236580465724811634148336929200213266140831603665217513011608681717494792540922272443225320166269546005384086341666270237, 20666343363156785654985613960098447088558685398640350288254320340496666688516590319064027915211047314924250684432033752242942966685842979794980296365888247039788491929724979065867747495180389495328018143172137761614969040970809046901475911809919819225814792921474015886234384233024615479366352095594442693243266913593735671556255730133253641239650968425165554567952946701451909296290474332348774876523488586367522569297383954521921027624472179940907798879661735838019525520096563628175856915838339369924996762439573028482405388108352766763640977505904313025884575825285855552752229632152736769500408011313183214392153, 14480286280129696514270349363639135690194813767915498959160314284345452109136054438918279879687988685577041179672481826413238969577366809496037008028319471115982075204004599853880859319285735251215720017350744902158301356474516391525891691871856049412845949704986820012935591952822443217869963788393612548023802605993419800696221415244404127247038175359086885939193086585037732169908522678773825469337954376145864799261157893957600692457882657459928699280090202008141189229552755119857595139897657107729811724161618369203527263317202234130089849201954557040754721260368951656599885121453704835178188315313686147051923, 25135420084057729138962207770153147249216029716010916549133072798022173651499205043606282483768583672328760981332426505696227594660119754631421070583142367295963352819026044721993905256646249896759721623276462449809859752925530184188042885144607718530989588516038414786694143648547597489366540402541899809051752326713817126431123487448396593702877775626937606471335455786422703851710737764866288332272933341502968739417462132708542330342772267969202023083086220041463278283077205795088208728884309357563743034975287256152505174426461145926368526423625546487258149118398734494641732919040020011403436393212191779432673, 14170383666109427589521313589398954693073999267690679429232942135812456809241794890000695435122337549594511547359442056505587452722540626257265898140591417773350910678019484155053006149919493857135172612823857432437751164396086806969247887722030626100150488635591461262100283389559941169785826738781070083631000931652943447440214092308220562550698836331050228146220398533720225203000322816574801344359625600962347408643059867457659818853613771081585704280121043234667995329377274986249499236061703041940482592689369088929027039513948760377275611911167035304174744652049727637136905531242917152702461696223811033602849]</span><br><span class="line">c= [15173807047472256447845684717251358912200122697842932385546098349809093752333910920794395969740005443648644569649151629387591807920298558650496538425219132987551223405408877632454158688064537658192460658356150057322506966948335987016028449001715452265499461776374053182409407643957629092529093158637338071846233068554991170358967852459399326506707061476129428800423426317404552334777482684000352415432732181431121500596157289667232882302431654245553236480148739150161235082097663476820421720676277364383804753596422154646210167713035821889664523396840593631837829893992707455057905959892044493550616949765027220821785, 11938220729710468926557967838524738768470825644612868603230757095292323093455865828959914062879644655551785832471143737493581841344185257107375234777532911128608967712481626952843271008996247807352342523498164298300504938844670197912254303803381691946636195711489073144969303997622633132286422880867271226194190255544078235550661988616892022747818310141637456428313681765661471975562221216381338670295432045738683059404018667138703833764008763778236536867798296840402557891175517847355068530786232834297244608865178392836134797580251614936231688236439984467175534272554294756436715223184842969069377142090754306086587, 8372259615196673779309934993544198416663757780787798713946610637626427463845006237283078696569258480955022027747227029707234987550305246888247136777153012680650117836880636761607863194764822189962747464025510178303075209848879650377247816192817842261342129001268715009974847247605278255193595427547890570752506772700910884836219465705104991007024562594310924752843471782461218371258698746171751166701903238716161531339945132602715536032022798223230723435175807913796348676823846038302524566716088962679362404006745480422576452325081934683229769895346449322176285464821570547521826791307002350786334042239662645563957, 5733976274584604503158989659243088656260484646101064598377820249243214941836104198790082691176209885137416348787627889019963374849716526301643203575745466143947067545186455524140490976182048095864032981061075827442834540637189552464126900919432241265888539704207825612690608583372413157779228956416948469330266827436190056447128563728081276323274058344982585240713393646248729347606147217955847165489399173144936327439947001621504890772515826043945534422085396820828587397025376566166372721369230275346318899064967181577034570239626240177509679081760324839630754365907895622832683887937718999018391437954527915504901, 11962620418277676374646808244354446889608161479405151063272409866849868879538467999438518866434088322058589141374532978662604437111947985330191441627067325730811388148805199455276493437021336994786423781063493329839484836248757775950256990830760793068417392697398710960950052662407124826751941922179917894234165713413459177376070935878803205790872796797683585051588692549376205056943215230738458048997617777633513907061623849828839043504459133638367820741574829044986070351587722416355383246077069665269193960717664499012759258851692437332541468322361668893398759490048718179565240789060484618800904819752877790839865, 14514190627252965989458912133650177358276024599448353767974956651001711285954527380677271379264744774560583389294677415329151572066496871191623403237537474484131590211694780397994927633637859321564626876861928816731833317835860346102068049048681141741602880112650970773766475860379331822623866557451204868940771037743371956603238411685645585455864559001752753943194800979965196045576484095541094062989278859774751950753918707697030394009501569165004933027458740532191312977538863175872726905565882031876620249853780381000852597492112187214600432630583588524386583025190254266601054787278440312207823089175947291805412, 7170711933239761804272372742798978256972824803609483931621008487728643522487624210005513129465353379861752443367806850891359310644714068239910036947843884154622114312629119056999639223587198702912932135706473355115493813596396494080029186640406895454294620829968679709936590321511385222821447179694303480562868112280011278299778419343863090503526288120666396481735329192528853631884136207219752754405396833982641885684715010162118882211883389908927141918526128685468851895086930506025457622185661218790174083864969366351390048046735613504180183923456680037579550089548742296821712544283816875194625748204510190006748]</span><br><span class="line">m = CRT(n, c)</span><br><span class="line">m1 = iroot(m, e)  # 开e次方</span><br><span class="line">print(m1)</span><br><span class="line">print(libnum.n2s(int(m1[0])))</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(mpz(13040004482819734622317003488996400249726426925342964419221160229528546987125461670186727037), True)</span><br><span class="line">b&#x27;flag&#123;2cb2eb4b2c7fdf4e94e10344be856446&#125;&#x27;</span><br></pre></td></tr></table></figure>
<h4 id="阶梯脚本2"><a class="markdownIt-Anchor" href="#阶梯脚本2">#</a> 阶梯脚本 2</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import binascii,gmpy2</span><br><span class="line">from functools import reduce</span><br><span class="line"></span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def CRT(mi, ai):</span><br><span class="line">    assert(reduce(gmpy2.gcd,mi)==1)</span><br><span class="line">    assert (isinstance(mi, list) and isinstance(ai, list))</span><br><span class="line">    M = reduce(lambda x, y: x * y, mi)</span><br><span class="line">    ai_ti_Mi = [a * (M // m) * gmpy2.invert(M // m, m) for (m, a) in zip(mi, ai)]</span><br><span class="line">    return reduce(lambda x, y: x + y, ai_ti_Mi) % M</span><br><span class="line"></span><br><span class="line">e= 23</span><br><span class="line">n= [28303622412582000131021407474534006627921799223355183106077505407831206380301837802779082885240206111505508547474437431362756095431762358110052438004267595363538307523189378160064363522004491855944919119597205658182749902342637937883927268605382518011199700158912849626569207674748509433787195694903010718581029837747981171596866887181030964844788562253129379797530253580033726662830283337751897717068387389316332038495989183875297434865972913656079980895151344185488446963115671720552088880147981915346363110130965930170755630143071342168860938247998306451689613273637151748431977358920444034764161368269864228260683, 20251452587759389751052720079014998244267616359016633593589175521621218456216360455295414295294412150809772398298894292213274346026242406070081445287045202845357692424984414731052455823237307016241779223277378745608301817094614950269964820345061379221697200410141112889155488951350825981000289053073683521941913801494200697246114178401082071562438086829634844209636507018099598320310860622688713956769159252262767722969006737392560062259268529057175218726693282184813651015664791336482617886917300606453413316038320561235717486917130822910721442930492265275565223486795987687552720234029811300311632264662984617939923, 14346699094920477306010014637065577396695146335017849885453710192053891302468843510448258124074965535071629427969248410027905493732280558837459311032388092215070142163153478283674348594955980639353521355441745601559314424603582895058504836475536927137989360726605508903641768784888818544654282487163986929656604018129571142512687134510041787214732147219138074791325301979785700412656267988690767850022868346773574953938614889361051066241822201821473385327983954592011097734422105185886881113996631236580465724811634148336929200213266140831603665217513011608681717494792540922272443225320166269546005384086341666270237, 20666343363156785654985613960098447088558685398640350288254320340496666688516590319064027915211047314924250684432033752242942966685842979794980296365888247039788491929724979065867747495180389495328018143172137761614969040970809046901475911809919819225814792921474015886234384233024615479366352095594442693243266913593735671556255730133253641239650968425165554567952946701451909296290474332348774876523488586367522569297383954521921027624472179940907798879661735838019525520096563628175856915838339369924996762439573028482405388108352766763640977505904313025884575825285855552752229632152736769500408011313183214392153, 14480286280129696514270349363639135690194813767915498959160314284345452109136054438918279879687988685577041179672481826413238969577366809496037008028319471115982075204004599853880859319285735251215720017350744902158301356474516391525891691871856049412845949704986820012935591952822443217869963788393612548023802605993419800696221415244404127247038175359086885939193086585037732169908522678773825469337954376145864799261157893957600692457882657459928699280090202008141189229552755119857595139897657107729811724161618369203527263317202234130089849201954557040754721260368951656599885121453704835178188315313686147051923, 25135420084057729138962207770153147249216029716010916549133072798022173651499205043606282483768583672328760981332426505696227594660119754631421070583142367295963352819026044721993905256646249896759721623276462449809859752925530184188042885144607718530989588516038414786694143648547597489366540402541899809051752326713817126431123487448396593702877775626937606471335455786422703851710737764866288332272933341502968739417462132708542330342772267969202023083086220041463278283077205795088208728884309357563743034975287256152505174426461145926368526423625546487258149118398734494641732919040020011403436393212191779432673, 14170383666109427589521313589398954693073999267690679429232942135812456809241794890000695435122337549594511547359442056505587452722540626257265898140591417773350910678019484155053006149919493857135172612823857432437751164396086806969247887722030626100150488635591461262100283389559941169785826738781070083631000931652943447440214092308220562550698836331050228146220398533720225203000322816574801344359625600962347408643059867457659818853613771081585704280121043234667995329377274986249499236061703041940482592689369088929027039513948760377275611911167035304174744652049727637136905531242917152702461696223811033602849]</span><br><span class="line">c= [15173807047472256447845684717251358912200122697842932385546098349809093752333910920794395969740005443648644569649151629387591807920298558650496538425219132987551223405408877632454158688064537658192460658356150057322506966948335987016028449001715452265499461776374053182409407643957629092529093158637338071846233068554991170358967852459399326506707061476129428800423426317404552334777482684000352415432732181431121500596157289667232882302431654245553236480148739150161235082097663476820421720676277364383804753596422154646210167713035821889664523396840593631837829893992707455057905959892044493550616949765027220821785, 11938220729710468926557967838524738768470825644612868603230757095292323093455865828959914062879644655551785832471143737493581841344185257107375234777532911128608967712481626952843271008996247807352342523498164298300504938844670197912254303803381691946636195711489073144969303997622633132286422880867271226194190255544078235550661988616892022747818310141637456428313681765661471975562221216381338670295432045738683059404018667138703833764008763778236536867798296840402557891175517847355068530786232834297244608865178392836134797580251614936231688236439984467175534272554294756436715223184842969069377142090754306086587, 8372259615196673779309934993544198416663757780787798713946610637626427463845006237283078696569258480955022027747227029707234987550305246888247136777153012680650117836880636761607863194764822189962747464025510178303075209848879650377247816192817842261342129001268715009974847247605278255193595427547890570752506772700910884836219465705104991007024562594310924752843471782461218371258698746171751166701903238716161531339945132602715536032022798223230723435175807913796348676823846038302524566716088962679362404006745480422576452325081934683229769895346449322176285464821570547521826791307002350786334042239662645563957, 5733976274584604503158989659243088656260484646101064598377820249243214941836104198790082691176209885137416348787627889019963374849716526301643203575745466143947067545186455524140490976182048095864032981061075827442834540637189552464126900919432241265888539704207825612690608583372413157779228956416948469330266827436190056447128563728081276323274058344982585240713393646248729347606147217955847165489399173144936327439947001621504890772515826043945534422085396820828587397025376566166372721369230275346318899064967181577034570239626240177509679081760324839630754365907895622832683887937718999018391437954527915504901, 11962620418277676374646808244354446889608161479405151063272409866849868879538467999438518866434088322058589141374532978662604437111947985330191441627067325730811388148805199455276493437021336994786423781063493329839484836248757775950256990830760793068417392697398710960950052662407124826751941922179917894234165713413459177376070935878803205790872796797683585051588692549376205056943215230738458048997617777633513907061623849828839043504459133638367820741574829044986070351587722416355383246077069665269193960717664499012759258851692437332541468322361668893398759490048718179565240789060484618800904819752877790839865, 14514190627252965989458912133650177358276024599448353767974956651001711285954527380677271379264744774560583389294677415329151572066496871191623403237537474484131590211694780397994927633637859321564626876861928816731833317835860346102068049048681141741602880112650970773766475860379331822623866557451204868940771037743371956603238411685645585455864559001752753943194800979965196045576484095541094062989278859774751950753918707697030394009501569165004933027458740532191312977538863175872726905565882031876620249853780381000852597492112187214600432630583588524386583025190254266601054787278440312207823089175947291805412, 7170711933239761804272372742798978256972824803609483931621008487728643522487624210005513129465353379861752443367806850891359310644714068239910036947843884154622114312629119056999639223587198702912932135706473355115493813596396494080029186640406895454294620829968679709936590321511385222821447179694303480562868112280011278299778419343863090503526288120666396481735329192528853631884136207219752754405396833982641885684715010162118882211883389908927141918526128685468851895086930506025457622185661218790174083864969366351390048046735613504180183923456680037579550089548742296821712544283816875194625748204510190006748]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m=gmpy2.iroot(CRT(n, c), e)[0]</span><br><span class="line">print(m)</span><br><span class="line">print(libnum.n2s(int(m)))</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">13040004482819734622317003488996400249726426925342964419221160229528546987125461670186727037</span><br><span class="line">b&#x27;flag&#123;2cb2eb4b2c7fdf4e94e10344be856446&#125;&#x27;</span><br></pre></td></tr></table></figure>
<h1 id="ctf-rsan不互素共享素数"><a class="markdownIt-Anchor" href="#ctf-rsan不互素共享素数">#</a> 【CTF-RSA】N 不互素（共享素数）</h1>
<p>两个 n 里使用有相同的素数 p 或 q 在 CTF 中，同样一个 e (一般为 65537) 和 m，有两个或多个 n 和 c 时，那么 n 之间可能是共享素数</p>
<h3 id="出题脚本-7"><a class="markdownIt-Anchor" href="#出题脚本-7">#</a> 出题脚本</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">#生成随机素数</span><br><span class="line">p1=libnum.generate_prime(1024)</span><br><span class="line">p2=libnum.generate_prime(1024)</span><br><span class="line">q=libnum.generate_prime(1024)</span><br><span class="line">e=65537</span><br><span class="line">m=&quot;flag&#123;c9d48baa792e91ce65d175bb586f8c24&#125;&quot;</span><br><span class="line">#字符串转数字</span><br><span class="line">m=libnum.s2n(m)</span><br><span class="line">print(q)</span><br><span class="line">n1=p1*q</span><br><span class="line">n2=p2*q</span><br><span class="line">#求逆元</span><br><span class="line">c1=pow(m,e,n1)</span><br><span class="line">c2=pow(m,e,n2)</span><br><span class="line"></span><br><span class="line">print (&quot;e=&quot;,e)</span><br><span class="line">print(&quot;n1=&quot;,n1)</span><br><span class="line">print(&quot;n2=&quot;,n2)</span><br><span class="line">print (&quot;c1=&quot;,c1)</span><br><span class="line">print (&quot;c2=&quot;,c2)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">112033192839831410128229314623644016892457474214603544009293323660253481717951000555944274929385767454448600673603543705582070863346470535753409649573999460325173934406017517052071246438800130085989821611221908264571097633716174917625191690203659123336145054187255755394681607476738638792807609503583942128287</span><br><span class="line">e= 65537</span><br><span class="line">n1= 10625543525346830676006870950185691831444597644902937688548664474839451789500623122399254396349043194137265309127150449785754269880715662352707412035793547680593086762929625928250971615306188339436585278519056416828788773974282747077277578312189120674125326857556669957819991694938110804921956107475524196753691190172084151806587432567633986959422611394848414182355921488672244553709452073236104935236677954344428768255255100054171572028934423627125634780087424402980388287407955842046167150933175146807998723396182109084926137033146724176484195516940148635702902548991068794155382834516404680151040115265524953368803</span><br><span class="line">n2= 16963368478863237165539514788629717230509794880335414979340928156272483952877461650346703404736600543573268654053853406528874405233365433480511950945751787459984056635129991630952167422872043167517367026291964118481932229618540409542768859684629875635644451769141400996752979258243212278679645758472226598679049513891130451209669678914961165598718327535139903961419600189590593818949508868366591386211578344734960982688428366608540144212331829055016414892080760884384459092360249396385618417969715029114886771538141181557047932980027849299798044339800149366277557448859678544386644358923506165421387377971452133400237</span><br><span class="line">c1= 3083814592613126614027965982601537654202006134791395656021465412286460166093457898156692884715856869567564841602842861925386434838975288348214401028294260689771237300101802894534580773219096180174526083320214279520998065109710357139026683126849406635064651704725592412836189737225530918963461500807604488934388123181506653107818366579852355169342727070144725895457018660958197755959464742004451789536791140205308500661680822479247916930501856845353744746803851281425962654216148374636811404978863628264660712674442063987082523071773406042384503834533479670504453823734240363238708085719130650821063973261950270161428</span><br><span class="line">c2= 13740386298909001233815681484510642184547992744157132970350241427600231037472755614023548206789735269078590834449245923454385325492305659242435611300542852213722841909380700099178894703174590126112041224283933050906079878737882887340652224562292433380944052673538602232295072801399008587550855279599758738224727323486864666105237460948172863914507051497974186625462313445057775348133531846046663852734437590095553782981005686291660604880068105148369641552089807164999699933504010826666901604098508377083799595612159033508965994444726491533830781284339377808073755805290835250781114692808914390954773552997805080977899</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="解题脚本-5"><a class="markdownIt-Anchor" href="#解题脚本-5">#</a> 解题脚本</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">e= 65537</span><br><span class="line">n1= 10625543525346830676006870950185691831444597644902937688548664474839451789500623122399254396349043194137265309127150449785754269880715662352707412035793547680593086762929625928250971615306188339436585278519056416828788773974282747077277578312189120674125326857556669957819991694938110804921956107475524196753691190172084151806587432567633986959422611394848414182355921488672244553709452073236104935236677954344428768255255100054171572028934423627125634780087424402980388287407955842046167150933175146807998723396182109084926137033146724176484195516940148635702902548991068794155382834516404680151040115265524953368803</span><br><span class="line">n2= 16963368478863237165539514788629717230509794880335414979340928156272483952877461650346703404736600543573268654053853406528874405233365433480511950945751787459984056635129991630952167422872043167517367026291964118481932229618540409542768859684629875635644451769141400996752979258243212278679645758472226598679049513891130451209669678914961165598718327535139903961419600189590593818949508868366591386211578344734960982688428366608540144212331829055016414892080760884384459092360249396385618417969715029114886771538141181557047932980027849299798044339800149366277557448859678544386644358923506165421387377971452133400237</span><br><span class="line">c1= 3083814592613126614027965982601537654202006134791395656021465412286460166093457898156692884715856869567564841602842861925386434838975288348214401028294260689771237300101802894534580773219096180174526083320214279520998065109710357139026683126849406635064651704725592412836189737225530918963461500807604488934388123181506653107818366579852355169342727070144725895457018660958197755959464742004451789536791140205308500661680822479247916930501856845353744746803851281425962654216148374636811404978863628264660712674442063987082523071773406042384503834533479670504453823734240363238708085719130650821063973261950270161428</span><br><span class="line">c2= 13740386298909001233815681484510642184547992744157132970350241427600231037472755614023548206789735269078590834449245923454385325492305659242435611300542852213722841909380700099178894703174590126112041224283933050906079878737882887340652224562292433380944052673538602232295072801399008587550855279599758738224727323486864666105237460948172863914507051497974186625462313445057775348133531846046663852734437590095553782981005686291660604880068105148369641552089807164999699933504010826666901604098508377083799595612159033508965994444726491533830781284339377808073755805290835250781114692808914390954773552997805080977899</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#求最大公约数</span><br><span class="line">q=gmpy2.gcd(n1,n2)</span><br><span class="line">p1=n1//q</span><br><span class="line"></span><br><span class="line">phi_n=(q-1)*(p1-1)</span><br><span class="line">#求逆元d</span><br><span class="line">d1=libnum.invmod(e,phi_n)</span><br><span class="line">m=pow(c1,d1,n1)</span><br><span class="line">print(m)</span><br><span class="line">#数字转字节，转字符串</span><br><span class="line">print(libnum.n2s(int(m)).decode())</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">13040004482825389441096275928544521243339469450955206317293093209414597159068563158095508605</span><br><span class="line">flag&#123;c9d48baa792e91ce65d175bb586f8c24&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">e= 65537</span><br><span class="line">n1= 10625543525346830676006870950185691831444597644902937688548664474839451789500623122399254396349043194137265309127150449785754269880715662352707412035793547680593086762929625928250971615306188339436585278519056416828788773974282747077277578312189120674125326857556669957819991694938110804921956107475524196753691190172084151806587432567633986959422611394848414182355921488672244553709452073236104935236677954344428768255255100054171572028934423627125634780087424402980388287407955842046167150933175146807998723396182109084926137033146724176484195516940148635702902548991068794155382834516404680151040115265524953368803</span><br><span class="line">n2= 16963368478863237165539514788629717230509794880335414979340928156272483952877461650346703404736600543573268654053853406528874405233365433480511950945751787459984056635129991630952167422872043167517367026291964118481932229618540409542768859684629875635644451769141400996752979258243212278679645758472226598679049513891130451209669678914961165598718327535139903961419600189590593818949508868366591386211578344734960982688428366608540144212331829055016414892080760884384459092360249396385618417969715029114886771538141181557047932980027849299798044339800149366277557448859678544386644358923506165421387377971452133400237</span><br><span class="line">c1= 3083814592613126614027965982601537654202006134791395656021465412286460166093457898156692884715856869567564841602842861925386434838975288348214401028294260689771237300101802894534580773219096180174526083320214279520998065109710357139026683126849406635064651704725592412836189737225530918963461500807604488934388123181506653107818366579852355169342727070144725895457018660958197755959464742004451789536791140205308500661680822479247916930501856845353744746803851281425962654216148374636811404978863628264660712674442063987082523071773406042384503834533479670504453823734240363238708085719130650821063973261950270161428</span><br><span class="line">c2= 13740386298909001233815681484510642184547992744157132970350241427600231037472755614023548206789735269078590834449245923454385325492305659242435611300542852213722841909380700099178894703174590126112041224283933050906079878737882887340652224562292433380944052673538602232295072801399008587550855279599758738224727323486864666105237460948172863914507051497974186625462313445057775348133531846046663852734437590095553782981005686291660604880068105148369641552089807164999699933504010826666901604098508377083799595612159033508965994444726491533830781284339377808073755805290835250781114692808914390954773552997805080977899</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#求最大公约数</span><br><span class="line">q=gmpy2.gcd(n1,n2)</span><br><span class="line">p1=n1//q</span><br><span class="line"></span><br><span class="line">phi_n=(q-1)*(p1-1)</span><br><span class="line">#求逆元d</span><br><span class="line">d1=libnum.invmod(e,phi_n)</span><br><span class="line">m=pow(c1,d1,n1)</span><br><span class="line">print(m)</span><br><span class="line">#数字转字节，转字符串</span><br><span class="line">print(libnum.n2s(int(m)).decode())</span><br></pre></td></tr></table></figure>
<h1 id="ctf-rsadp泄露"><a class="markdownIt-Anchor" href="#ctf-rsadp泄露">#</a> 【CTF-RSA】dp 泄露</h1>
<h3 id="出题脚本-8"><a class="markdownIt-Anchor" href="#出题脚本-8">#</a> 出题脚本</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">#coding:utf-8</span><br><span class="line">import random</span><br><span class="line">import base64</span><br><span class="line">import hashlib</span><br><span class="line">import string</span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">def put_flag():</span><br><span class="line">    # 字符串列表</span><br><span class="line">    a = string.printable</span><br><span class="line">    flag = &quot;&quot;</span><br><span class="line">    for i in range(10):</span><br><span class="line">        flag += a[random.randint(0, 99)]</span><br><span class="line">    flag = r&quot;flag&#123;%s&#125;&quot;%(hashlib.md5(flag.encode()).hexdigest())</span><br><span class="line">    print(flag)</span><br><span class="line">    return flag</span><br><span class="line"></span><br><span class="line">#生成素数</span><br><span class="line">p=libnum.generate_prime(1024)</span><br><span class="line">q=libnum.generate_prime(1024)</span><br><span class="line">e=65537</span><br><span class="line">n=p*q</span><br><span class="line">phi_n=(p-1)*(q-1)</span><br><span class="line">d=libnum.invmod(e,phi_n)</span><br><span class="line">dp=d%(p-1)</span><br><span class="line">m=put_flag()</span><br><span class="line">m=libnum.s2n(m)</span><br><span class="line">n=p*q</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line"></span><br><span class="line">print(&quot;n=&quot;,n)</span><br><span class="line">print(&quot;e=&quot;,e)</span><br><span class="line">print(&quot;dp=&quot;,dp)</span><br><span class="line">print(&quot;c=&quot;,c)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;d4b1e0f286ad786066f7080b799b060c&#125;</span><br><span class="line">n= 23394036014464046501402792776884457087634068433705842139487912015519104667457488035047083371965503536792460851787650081706327143805464933298095489389084818332774953793854059606978467021122060941721159940921809773870657335464362378719134317047572114687528866506353323318174138423377776372281089909340016072870263135215376731630674713954427795890261571486636276952127575752748522492589539506478258930649380768233506393076363278803060558598509815268954407266874717384390312718209478291926475527005153885465608428599031442715759260865813504888269596677881780347479592998255350058004619030108388912201581076089336119468643</span><br><span class="line">e= 65537</span><br><span class="line">dp= 100674509715202325036081726312774815986187000783697455044387277186714326573821809713063426618185153848167198579179497656982506746232819368900025150095426269713393750558196053535255114827412538046108647122641808177368947613148236456610301824596042041271055359866313832084853116512985378487355450567630091705649</span><br><span class="line">c= 12127459340286917726546036238419091529597268566270618006396964642315960697809670228324352194626974775143594040184007995762230124277685135428557682256725346270076456760491553841122346906694778065552795002359965526224770887646547543805440124941737783340421200375963056356821003236095664853156958927717936209155044726879318559032451125971549741240792191258921980127372316983196390340347224459405077718348857806559168064784227269021302828794546867944957250008076452307745983922147833828528029871263104355277353451384507030114318047568878694705985438014743749080234970796793239251039347382419944322804681983892197888703621</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="解题脚本-6"><a class="markdownIt-Anchor" href="#解题脚本-6">#</a> 解题脚本</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#coding:utf-8</span><br><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">n= 23394036014464046501402792776884457087634068433705842139487912015519104667457488035047083371965503536792460851787650081706327143805464933298095489389084818332774953793854059606978467021122060941721159940921809773870657335464362378719134317047572114687528866506353323318174138423377776372281089909340016072870263135215376731630674713954427795890261571486636276952127575752748522492589539506478258930649380768233506393076363278803060558598509815268954407266874717384390312718209478291926475527005153885465608428599031442715759260865813504888269596677881780347479592998255350058004619030108388912201581076089336119468643</span><br><span class="line">e= 65537</span><br><span class="line">dp= 100674509715202325036081726312774815986187000783697455044387277186714326573821809713063426618185153848167198579179497656982506746232819368900025150095426269713393750558196053535255114827412538046108647122641808177368947613148236456610301824596042041271055359866313832084853116512985378487355450567630091705649</span><br><span class="line">c= 12127459340286917726546036238419091529597268566270618006396964642315960697809670228324352194626974775143594040184007995762230124277685135428557682256725346270076456760491553841122346906694778065552795002359965526224770887646547543805440124941737783340421200375963056356821003236095664853156958927717936209155044726879318559032451125971549741240792191258921980127372316983196390340347224459405077718348857806559168064784227269021302828794546867944957250008076452307745983922147833828528029871263104355277353451384507030114318047568878694705985438014743749080234970796793239251039347382419944322804681983892197888703621</span><br><span class="line">for i in range(1,65535):</span><br><span class="line">    p=(dp*e-1)//i+1</span><br><span class="line">    if n%p==0:</span><br><span class="line">        q=n//p</span><br><span class="line">        break</span><br><span class="line">print(p)</span><br><span class="line">print(q)</span><br><span class="line">phi_n= (p-1)*(q-1)</span><br><span class="line">d=gmpy2.invert(e,phi_n)</span><br><span class="line">m=pow(c,d,n)</span><br><span class="line">print(m)</span><br><span class="line">flag=libnum.n2s(int(m)).decode()</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">134667619365743045595168553238362312023650599468530434568396313527895187587634403052721512639833457724360813431924046576022830236924118932514204765110094122509015108591511098512879423203741999141278981231917707934037407023776298580578629029647524334791630712323113230463832687613004097438988736658586221172249</span><br><span class="line">173716860256720756010986199782897012515331445068177358103829931240562092491287733676752639070657545014548803292723216412791088678565614337516811748594976169892097100242359937925941407901138820607539009613167988691437541846667829527629900122609755232483505146549072069287070281676499661836078738207039875462107</span><br><span class="line">13040004482825502968068078893777661764720816096319462874883263755612616818670936876452438909</span><br><span class="line">flag&#123;d4b1e0f286ad786066f7080b799b060c&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="题目解析"><a class="markdownIt-Anchor" href="#题目解析">#</a> 题目解析</h3>
<p>已知公钥 n，e 以及 dp</p>
<p>其中，dp = d mod (p-1)</p>
<p>已知：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">c = m^e mod n</span><br><span class="line">m = c^d mod n</span><br><span class="line">ϕ(n)=(p−1)*(q−1)</span><br><span class="line">d∗e ≡ 1 mod ϕ(n)</span><br><span class="line">dp = d mod (p−1)</span><br></pre></td></tr></table></figure>
<p>由上式可以得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dp*e≡d*e mod (p−1)</span><br></pre></td></tr></table></figure>
<p>因此可以得到</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">式<span class="number">1</span>：d∗e=k∗(p−<span class="number">1</span>)+dp∗e</span><br><span class="line">式<span class="number">2</span>：d∗e≡<span class="number">1</span> mod ϕ(n)</span><br></pre></td></tr></table></figure>
<p>式 1 带入式 2</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">=&gt; k∗(p−<span class="number">1</span>)+dp∗e ≡<span class="number">1</span> mod ϕ(n)</span><br><span class="line"></span><br><span class="line">=&gt; k∗(p−<span class="number">1</span>)+dp∗e ≡<span class="number">1</span> mod (p−<span class="number">1</span>)∗(q−<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">=&gt; k1∗(p−<span class="number">1</span>)+dp∗e = k2*(p−<span class="number">1</span>)∗(q−<span class="number">1</span>)+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">=&gt; dp*e =  k2*(p−<span class="number">1</span>)∗(q−<span class="number">1</span>)+<span class="number">1</span>-k1∗(p−<span class="number">1</span>)+dp∗e</span><br><span class="line"></span><br><span class="line">=&gt; dp*e = (p-<span class="number">1</span>)*[k2*(p-<span class="number">1</span>)-k1]+<span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>因 dp&lt;p−1（dp 是 d//（p-1）的余数，dp&lt;p−1）</p>
<p>所以 e &gt; k2∗(q−1)−k1</p>
<p>假设 x=k2∗(q−1)−k1</p>
<p>x 的范围为 (0,e)</p>
<p>x∗(p−1)+1=dp∗e</p>
<p>求出 p-1 方法，遍历 (0,e) 的范围，其中肯定有一个 p 可以被 n 整除，那么求出 p 和 q</p>
<h1 id="ctf-rsadpdq"><a class="markdownIt-Anchor" href="#ctf-rsadpdq">#</a> 【CTF-RSA】dp,dq</h1>
<h3 id="出题脚本-9"><a class="markdownIt-Anchor" href="#出题脚本-9">#</a> 出题脚本</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#coding:utf-8</span><br><span class="line">import random</span><br><span class="line">import base64</span><br><span class="line">import hashlib</span><br><span class="line">import string</span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">def put_flag():</span><br><span class="line">    # 字符串列表</span><br><span class="line">    a = string.printable</span><br><span class="line">    flag = &quot;&quot;</span><br><span class="line">    for i in range(10):</span><br><span class="line">        flag += a[random.randint(0, 99)]</span><br><span class="line">    flag = r&quot;flag&#123;%s&#125;&quot;%(hashlib.md5(flag.encode()).hexdigest())</span><br><span class="line">    print(flag)</span><br><span class="line">    return flag</span><br><span class="line">#生成素数</span><br><span class="line">p=libnum.generate_prime(1024)</span><br><span class="line">q=libnum.generate_prime(1024)</span><br><span class="line">e=65537</span><br><span class="line">n=p*q</span><br><span class="line">phi_n=(p-1)*(q-1)</span><br><span class="line">d=libnum.invmod(e,phi_n)</span><br><span class="line">dp=d%(p-1)</span><br><span class="line">dq=d%(q-1)</span><br><span class="line">m=put_flag()</span><br><span class="line">m=libnum.s2n(m)</span><br><span class="line">n=p*q</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line"></span><br><span class="line">print(&quot;p=&quot;,p)</span><br><span class="line">print(&quot;q=&quot;,q)</span><br><span class="line">print(&quot;dq=&quot;,dq)</span><br><span class="line">print(&quot;dp=&quot;,dp)</span><br><span class="line">print(&quot;c=&quot;,c)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;cf0e0667c7442c2062d44325dfa1fff8&#125;</span><br><span class="line">p= 116448890546185683618055771450262312142016242676238094735985217275558021426787268511630302385159616509824437310766062886645283012210550645169977349508799805936368080215259139246007436664580533527641021648562878099835855488217605507804587234251629324592836704958089773215930952831323766320054699221381397968349</span><br><span class="line">q= 121314447894794933957911141434811889490960407007692356648851565427612228833554613770868517878896771681675653370553153871839922174394592991198603832478356982707395565149507463608294194106890694113693573162935964314084535850523178363478442420170042255278617265943573098151866633751578364943738065761428628706039</span><br><span class="line">dq= 59454945327569441442149441563463739239821128716298744269717311289340024381722395588850968548335831814757164816955258086418762841133709695047194050618312524643771276638189575715012912103380109010753068898795188028199051024351953337146407252291706779335244334724531552245903907860703808590993224196886127308379</span><br><span class="line">dp= 12821691474758928437186481633048397766403546197594245870498639361893688795881668821885717411711121850784948039038831649145251723699762477006066139036811257757249066433210399450679610952158523123357151108778701014212056291911107333938353929571993792914871136350116358751944058404120303000831815761806127343937</span><br><span class="line">c= 9983837067627475378248837281152077424577644386920613072097254241896471299255096730106667334607635347860798847959593316696048354026485880426581453490989579741802704101509576499437856377836305511877118962352017825827558857421137932247147226103427393215520334795953723215808736388183152444480701951305372405468290514418251173641350383981901755628956285657852767644612558903853975128656097276863834433887282035569179705730464360229607976686393639473868252704891915443982668342477474154848246082390458011231850434283927962815103615634851592101896052435074200941912168878340717415600997946705421433642907356895602555961692</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="解题脚本-7"><a class="markdownIt-Anchor" href="#解题脚本-7">#</a> 解题脚本</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># coding=utf-8</span><br><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">def decrypt(dp,dq,p,q,c):</span><br><span class="line">    InvQ = gmpy2.invert(q, p)</span><br><span class="line">    mp = pow(c, dp, p)</span><br><span class="line">    mq = pow(c, dq, q)</span><br><span class="line">    m = (((mp-mq)*InvQ) % p)*q+mq</span><br><span class="line">    print(libnum.n2s(int(m)).decode())</span><br><span class="line"></span><br><span class="line">p= 116448890546185683618055771450262312142016242676238094735985217275558021426787268511630302385159616509824437310766062886645283012210550645169977349508799805936368080215259139246007436664580533527641021648562878099835855488217605507804587234251629324592836704958089773215930952831323766320054699221381397968349</span><br><span class="line">q= 121314447894794933957911141434811889490960407007692356648851565427612228833554613770868517878896771681675653370553153871839922174394592991198603832478356982707395565149507463608294194106890694113693573162935964314084535850523178363478442420170042255278617265943573098151866633751578364943738065761428628706039</span><br><span class="line">dq= 59454945327569441442149441563463739239821128716298744269717311289340024381722395588850968548335831814757164816955258086418762841133709695047194050618312524643771276638189575715012912103380109010753068898795188028199051024351953337146407252291706779335244334724531552245903907860703808590993224196886127308379</span><br><span class="line">dp= 12821691474758928437186481633048397766403546197594245870498639361893688795881668821885717411711121850784948039038831649145251723699762477006066139036811257757249066433210399450679610952158523123357151108778701014212056291911107333938353929571993792914871136350116358751944058404120303000831815761806127343937</span><br><span class="line">c= 9983837067627475378248837281152077424577644386920613072097254241896471299255096730106667334607635347860798847959593316696048354026485880426581453490989579741802704101509576499437856377836305511877118962352017825827558857421137932247147226103427393215520334795953723215808736388183152444480701951305372405468290514418251173641350383981901755628956285657852767644612558903853975128656097276863834433887282035569179705730464360229607976686393639473868252704891915443982668342477474154848246082390458011231850434283927962815103615634851592101896052435074200941912168878340717415600997946705421433642907356895602555961692</span><br><span class="line"></span><br><span class="line">decrypt(dp,dq,p,q,c)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;cf0e0667c7442c2062d44325dfa1fff8&#125;</span><br></pre></td></tr></table></figure>
<h3 id="题目解析-2"><a class="markdownIt-Anchor" href="#题目解析-2">#</a> 题目解析</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">已知条件：</span><br><span class="line">c = m^e mod n</span><br><span class="line">m = c^d mod n</span><br><span class="line">Φ(n) = (p-1)*(q-1)</span><br><span class="line">d*e ≡ 1 mod Φ(n)</span><br><span class="line">dp = d mod (p-1)</span><br><span class="line">dq = d mod (q-1)</span><br></pre></td></tr></table></figure>
<p>首先根据</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">m=c^d mod n</span><br><span class="line"></span><br><span class="line"><span class="title function_">gcd</span>(p,q)=<span class="number">1</span></span><br><span class="line">n=p∗q</span><br><span class="line"></span><br><span class="line">利用中国剩余定理,得：</span><br><span class="line">m1=c^d mod p</span><br><span class="line">m2=c^d mod q</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">已知条件</span><br><span class="line">c = m^e mod n</span><br><span class="line">m = c^d mod n</span><br><span class="line">ϕ(n)= (p−<span class="number">1</span>)*(q−<span class="number">1</span>)</span><br><span class="line">d*e≡ <span class="number">1</span> mod ϕ(n)</span><br><span class="line">dp= d mod (p−<span class="number">1</span>)</span><br><span class="line">dq= d mod (q−<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m=c^d mod n</span><br><span class="line">m=c^d+k*n</span><br><span class="line"></span><br><span class="line">因为 n=p*q</span><br><span class="line">m=c^d+p*q*k</span><br><span class="line"></span><br><span class="line">同时取余q和p</span><br><span class="line"></span><br><span class="line">式<span class="number">1</span> m1=c^d mod q</span><br><span class="line">式<span class="number">1</span> c^d=kp+m1</span><br><span class="line"></span><br><span class="line">式<span class="number">2</span> m2=c^d mod p</span><br><span class="line"></span><br><span class="line">式<span class="number">1</span>带入式<span class="number">2</span></span><br><span class="line">m2=(kp+m1) mod q</span><br><span class="line"></span><br><span class="line">等式两边同时减去m1</span><br><span class="line">(m2−m1)≡kp mod q</span><br><span class="line"></span><br><span class="line">因为<span class="title function_">gcd</span>(p,q)=<span class="number">1</span></span><br><span class="line">所以可以求p的逆元，得到</span><br><span class="line">(m2−m1)*p−<span class="number">1</span>≡k mod q</span><br><span class="line"></span><br><span class="line">得到如下两个式子</span><br><span class="line">k≡(m2−m1)*p−<span class="number">1</span> mod q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c^d=kp+m1</span><br><span class="line">m≡c^d mod n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">上下两个式子合并</span><br><span class="line"></span><br><span class="line">c^d = ((m2−m1)*p−<span class="number">1</span> mod q)p+m1</span><br><span class="line">m ≡ c^d mod n</span><br><span class="line"></span><br><span class="line">最后可以有</span><br><span class="line"></span><br><span class="line">m≡(((m2−m1)*p−<span class="number">1</span> mod q)p+m1) mod n</span><br><span class="line"></span><br><span class="line">只剩最后一步了</span><br><span class="line"></span><br><span class="line">m1≡cd mod q</span><br><span class="line">m2≡cd mod p</span><br><span class="line"></span><br><span class="line">m1和m2怎么求</span><br><span class="line"></span><br><span class="line">d≡dp mod (p−<span class="number">1</span>)</span><br><span class="line">d≡dq mod (q−<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">那么分别带入</span><br><span class="line"></span><br><span class="line">m1≡cdq mod (q−<span class="number">1</span>) mod q</span><br><span class="line">m2≡cdp mod (p−<span class="number">1</span>) mod p</span><br><span class="line"></span><br><span class="line">费马小定理即假如p是质数，且<span class="title function_">gcd</span>(a,p)=<span class="number">1</span></span><br><span class="line">a^(p−<span class="number">1</span>)≡<span class="number">1</span> mod p</span><br><span class="line"></span><br><span class="line">所以如果我们有等式</span><br><span class="line"></span><br><span class="line">d=dp+k*(p−<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">直接带入</span><br><span class="line">m2≡c^dp+k*(p−<span class="number">1</span>) mod p</span><br><span class="line"></span><br><span class="line">这里的指数，我们拆开，为</span><br><span class="line">m2≡c^dp*ck*(p−<span class="number">1</span>) mod p</span><br><span class="line"></span><br><span class="line">ck*(p−<span class="number">1</span>)≡<span class="number">1</span> mod p</span><br><span class="line"></span><br><span class="line">因为p是大素数，显然和c互素所以可以直接得到</span><br><span class="line">m2≡cd^p mod p</span><br><span class="line"></span><br><span class="line">那么m1根据对称性也可以同理得到</span><br><span class="line"></span><br><span class="line">m1≡cd^q mod q</span><br><span class="line"></span><br><span class="line">故此，我们现在拥有了所有条件，下面归纳一下为</span><br><span class="line"></span><br><span class="line">m1≡cd^q mod q</span><br><span class="line">m2≡cd^p mod p</span><br><span class="line">m≡(((m2−m1)*p−<span class="number">1</span> mod q)p+m1) mod n</span><br></pre></td></tr></table></figure>

      <div class="tags">
          <a href="/tags/rsa/" rel="tag"><i class="ic i-tag"></i> rsa</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">更新于</span>
    <time title="修改时间：2024-05-21 20:33:30" itemprop="dateModified" datetime="2024-05-21T20:33:30+08:00">2024-05-21</time>
  </span>
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> 赞赏</button>
  <p>请我喝[茶]~(￣▽￣)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="/images/wechatpay.png" alt="luren 微信支付">
        <p>微信支付</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>本文作者： </strong>luren <i class="ic i-at"><em>@</em></i>圥忈的博客
  </li>
  <li class="link">
    <strong>本文链接：</strong>
    <a href="http://example.com/2024/05/15/rsa/" title="&#39;rsa&#39;">http://example.com/2024/05/15/rsa/</a>
  </li>
  <li class="license">
    <strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2024/05/11/Base%E5%AE%B6%E6%97%8F%E7%BC%96%E7%A0%81/" itemprop="url" rel="prev" data-background-image="&#x2F;.&#x2F;assets&#x2F;base.jpg" title="&#39;Base家族编码&#39;">
  <span class="type">上一篇</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>'Base家族编码'</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2024/05/21/matlab/" itemprop="url" rel="next" data-background-image="&#x2F;.&#x2F;assets&#x2F;matlab.jpg" title="&#39;matlab&#39;">
  <span class="type">下一篇</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>'matlab'</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="文章目录">
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ctf-rsapython%E5%AE%89%E8%A3%85%E5%8F%8Apycharm%E9%85%8D%E7%BD%AE"><span class="toc-number">1.</span> <span class="toc-text"> 【CTF-RSA】python 安装及 pycharm 配置</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ctf-rsarsa%E7%AE%80%E4%BB%8B%E5%8F%8A%E5%8E%9F%E7%90%86"><span class="toc-number">2.</span> <span class="toc-text"> 【CTF-RSA】RSA 简介及原理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#rsa%E7%AE%97%E6%B3%95%E7%AE%80%E4%BB%8B"><span class="toc-number">2.1.</span> <span class="toc-text"> rsa 算法简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rsa%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86"><span class="toc-number">2.2.</span> <span class="toc-text"> rsa 算法原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0%CF%86n"><span class="toc-number">2.2.1.</span> <span class="toc-text"> 欧拉函数 φ(n)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AC%A7%E6%8B%89%E5%AE%9A%E7%90%86"><span class="toc-number">2.2.2.</span> <span class="toc-text"> 欧拉定理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B4%B9%E9%A9%AC%E5%B0%8F%E5%AE%9A%E7%90%86"><span class="toc-number">2.2.3.</span> <span class="toc-text"> 费马小定理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E8%BF%90%E7%AE%97"><span class="toc-number">2.2.4.</span> <span class="toc-text"> 模运算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A8%E5%AF%BC%E8%BF%87%E7%A8%8B"><span class="toc-number">2.2.5.</span> <span class="toc-text"> 推导过程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ctf-rsarsa%E5%9F%BA%E7%A1%80%E9%A2%98%E7%9B%AE%E5%8F%8A%E8%84%9A%E6%9C%AC"><span class="toc-number">3.</span> <span class="toc-text"> 【CTF-RSA】RSA 基础题目及脚本</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90flag"><span class="toc-number">3.0.1.</span> <span class="toc-text"> 随机生成 flag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BA%E9%A2%98%E8%84%9A%E6%9C%AC"><span class="toc-number">3.0.2.</span> <span class="toc-text"> 出题脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%B2%E7%9F%A5ndec%E6%B1%82m"><span class="toc-number">3.0.3.</span> <span class="toc-text"> 已知 n,d,e,c 求 m</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%B2%E7%9F%A5pqec%E6%B1%82m"><span class="toc-number">3.0.4.</span> <span class="toc-text"> 已知 p,q,e,c 求 m</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ctf-rsa%E5%9F%BA%E4%BA%8En%E5%88%86%E8%A7%A3%E7%9A%84rsa%E9%A2%98%E7%9B%AE"><span class="toc-number">4.</span> <span class="toc-text"> 【CTF-RSA】基于 N 分解的 RSA 题目</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E5%9C%A8%E7%BA%BF%E6%9F%A5%E8%AF%A2%E5%88%86%E8%A7%A3%E7%BD%91%E7%AB%99"><span class="toc-number">4.0.1.</span> <span class="toc-text"> 1. 在线查询分解网站</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E4%BD%BF%E7%94%A8yafu%E5%B7%A5%E5%85%B7%E5%88%86%E8%A7%A3"><span class="toc-number">4.0.2.</span> <span class="toc-text"> 2. 使用 yafu 工具分解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E4%BD%BF%E7%94%A8%E8%B4%B9%E9%A9%AC%E5%88%86%E8%A7%A3"><span class="toc-number">4.0.3.</span> <span class="toc-text"> 3. 使用费马分解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E5%88%86%E8%A7%A3%E5%87%BA%E6%9D%A5%E5%90%8E%E7%94%A8%E8%84%9A%E6%9C%AC%E8%A7%A3%E5%AF%86%E5%8D%B3%E5%8F%AF"><span class="toc-number">4.0.4.</span> <span class="toc-text"> 4. 分解出来后，用脚本解密即可</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BA%E9%A2%98%E8%84%9A%E6%9C%AC-2"><span class="toc-number">4.0.4.1.</span> <span class="toc-text"> 出题脚本</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E8%84%9A%E6%9C%AC"><span class="toc-number">4.0.5.</span> <span class="toc-text"> 解题脚本</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ctf-rsarsa%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E4%B8%8E%E8%AF%BB%E5%8F%96"><span class="toc-number">5.</span> <span class="toc-text"> 【CTF-RSA】RSA 密钥生成与读取</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85pycryptodome%E6%A8%A1%E5%9D%97"><span class="toc-number">5.1.</span> <span class="toc-text"> 安装 pycryptodome 模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AC%E9%92%A5%E7%94%9F%E6%88%90"><span class="toc-number">5.1.1.</span> <span class="toc-text"> 公钥生成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%81%E9%92%A5%E7%94%9F%E6%88%90"><span class="toc-number">5.1.2.</span> <span class="toc-text"> 私钥生成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AC%E9%92%A5%E8%AF%BB%E5%8F%96"><span class="toc-number">5.1.3.</span> <span class="toc-text"> 公钥读取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%81%E9%92%A5%E8%AF%BB%E5%8F%96"><span class="toc-number">5.1.4.</span> <span class="toc-text"> 私钥读取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BA%E9%A2%98%E8%84%9A%E6%9C%AC-%E5%9F%BA%E4%BA%8En%E5%88%86%E8%A7%A3%E7%9A%84%E9%A2%98%E7%9B%AE"><span class="toc-number">5.1.5.</span> <span class="toc-text"> 出题脚本 - 基于 N 分解的题目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E8%84%9A%E6%9C%AC-2"><span class="toc-number">5.1.6.</span> <span class="toc-text"> 解题脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9B%E9%98%B6%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E5%AF%86%E9%92%A5%E5%8F%8A%E5%8A%A0%E8%A7%A3%E5%AF%86"><span class="toc-number">5.1.7.</span> <span class="toc-text"> 进阶 —— 自动生成密钥及加解密</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ctf-rsa%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB%E8%84%9A%E6%9C%AC"><span class="toc-number">6.</span> <span class="toc-text"> 【CTF-RSA】共模攻击脚本</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BA%E9%A2%98%E8%84%9A%E6%9C%AC-3"><span class="toc-number">6.0.1.</span> <span class="toc-text"> 出题脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%AF%86%E8%84%9A%E6%9C%AC"><span class="toc-number">6.0.2.</span> <span class="toc-text"> 解密脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB%E5%8E%9F%E7%90%86"><span class="toc-number">6.0.3.</span> <span class="toc-text"> 共模攻击原理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ctf-rsawiener%E7%BB%B4%E7%BA%B3%E6%94%BB%E5%87%BB%E8%84%9A%E6%9C%AC"><span class="toc-number">7.</span> <span class="toc-text"> 【CTF-RSA】wiener (维纳) 攻击脚本</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BA%E9%A2%98%E8%84%9A%E6%9C%AC-4"><span class="toc-number">7.0.1.</span> <span class="toc-text"> 出题脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E8%84%9A%E6%9C%AC-3"><span class="toc-number">7.0.2.</span> <span class="toc-text"> 解题脚本</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ctf-rsa%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB"><span class="toc-number">8.</span> <span class="toc-text"> 【CTF-RSA】低加密指数攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BA%E9%A2%98%E8%84%9A%E6%9C%AC-5"><span class="toc-number">8.0.1.</span> <span class="toc-text"> 出题脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E8%84%9A%E6%9C%AC-4"><span class="toc-number">8.0.2.</span> <span class="toc-text"> 解题脚本</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ctf-rsa%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E5%B9%BF%E6%92%AD%E6%94%BB%E5%87%BB"><span class="toc-number">9.</span> <span class="toc-text"> 【CTF-RSA】低加密指数广播攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BA%E9%A2%98%E8%84%9A%E6%9C%AC-6"><span class="toc-number">9.0.1.</span> <span class="toc-text"> 出题脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%AF%86%E8%84%9A%E6%9C%AC-2"><span class="toc-number">9.0.2.</span> <span class="toc-text"> 解密脚本</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%AF%86%E8%84%9A%E6%9C%AC1"><span class="toc-number">9.0.2.1.</span> <span class="toc-text"> 解密脚本 1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%98%B6%E6%A2%AF%E8%84%9A%E6%9C%AC2"><span class="toc-number">9.0.2.2.</span> <span class="toc-text"> 阶梯脚本 2</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ctf-rsan%E4%B8%8D%E4%BA%92%E7%B4%A0%E5%85%B1%E4%BA%AB%E7%B4%A0%E6%95%B0"><span class="toc-number">10.</span> <span class="toc-text"> 【CTF-RSA】N 不互素（共享素数）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BA%E9%A2%98%E8%84%9A%E6%9C%AC-7"><span class="toc-number">10.0.1.</span> <span class="toc-text"> 出题脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E8%84%9A%E6%9C%AC-5"><span class="toc-number">10.0.2.</span> <span class="toc-text"> 解题脚本</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ctf-rsadp%E6%B3%84%E9%9C%B2"><span class="toc-number">11.</span> <span class="toc-text"> 【CTF-RSA】dp 泄露</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BA%E9%A2%98%E8%84%9A%E6%9C%AC-8"><span class="toc-number">11.0.1.</span> <span class="toc-text"> 出题脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E8%84%9A%E6%9C%AC-6"><span class="toc-number">11.0.2.</span> <span class="toc-text"> 解题脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90"><span class="toc-number">11.0.3.</span> <span class="toc-text"> 题目解析</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ctf-rsadpdq"><span class="toc-number">12.</span> <span class="toc-text"> 【CTF-RSA】dp,dq</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BA%E9%A2%98%E8%84%9A%E6%9C%AC-9"><span class="toc-number">12.0.1.</span> <span class="toc-text"> 出题脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E8%84%9A%E6%9C%AC-7"><span class="toc-number">12.0.2.</span> <span class="toc-text"> 解题脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90-2"><span class="toc-number">12.0.3.</span> <span class="toc-text"> 题目解析</span></a></li></ol></li></ol></li></ol>
      </div>
      <div class="related panel pjax" data-title="系列文章">
      </div>
      <div class="overview panel" data-title="站点概览">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="luren"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">luren</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">7</span>
        <span class="name">文章</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">5</span>
        <span class="name">标签</span>
      </a>
    </div>
</nav>

<div class="social">
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>首页</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2024/05/11/Base%E5%AE%B6%E6%97%8F%E7%BC%96%E7%A0%81/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2024/05/21/matlab/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>随机文章</h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2024/05/08/number-theory/" title="&#39;number-theory&#39;">'number-theory'</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2024/05/15/rsa/" title="&#39;rsa&#39;">'rsa'</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2024/05/25/1/" title="&#39;1&#39;">'1'</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2024/05/11/Base%E5%AE%B6%E6%97%8F%E7%BC%96%E7%A0%81/" title="&#39;Base家族编码&#39;">'Base家族编码'</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2024/05/21/matlab/" title="&#39;matlab&#39;">'matlab'</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2024/05/08/buuctf/" title="&#39;buuctf&#39;">'buuctf'</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2024/05/07/python%E5%B0%8F%E7%BB%93/" title="&#39;python小结&#39;">'python小结'</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>最新评论</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 – 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">luren @ Yume Shoka</span>
  </div>
  <div class="powered-by">
    基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2024/05/15/rsa/',
    favicon: {
      show: "（●´3｀●）やれやれだぜ",
      hide: "(´Д｀)大変だ！"
    },
    search : {
      placeholder: "文章搜索",
      empty: "关于 「 ${query} 」，什么也没搜到",
      stats: "${time} ms 内找到 ${hits} 条结果"
    },
    valine: true,fancybox: true,
    copyright: '复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
